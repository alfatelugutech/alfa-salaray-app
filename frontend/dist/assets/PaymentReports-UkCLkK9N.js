import{j as e}from"./index-B0dpTzod.js";import{r as u}from"./router-BXhMSvr3.js";import{a as y}from"./query-DSXC375t.js";import{p as D}from"./payrollService-Ivxr9Vn-.js";import{e as J}from"./employeeService-CpNx_TMG.js";import{r as z,l as V,D as Q,A as q,h as G,s as W,t as X,U as Z,a as ee,z as k,u as se,v as te,j as ae,w as re,B as le,p as ne}from"./ui-BANi3Jhe.js";import"./vendor-C8w-UNLI.js";import"./utils-ngrFHoWO.js";const ue=()=>{var A,C,S,M;const[x,O]=u.useState(new Date().getFullYear()),[o,T]=u.useState(""),[v,Y]=u.useState("all"),[b,L]=u.useState("all"),[f,U]=u.useState("summary"),{data:p}=y(["payment-stats",x,o],()=>D.getPaymentStats({year:x,month:o?Number(o):void 0})),{data:N}=y("employees",()=>J.getEmployees({page:1,limit:1e3})),{data:l,isLoading:B}=y(["payment-data",x,o,v,b],()=>D.getPayrolls({year:x,month:o?Number(o):void 0,status:"PAID",limit:1e3})),F=()=>{var n,d;const s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a=[];for(let r=0;r<12;r++){const c=((d=(n=l==null?void 0:l.data)==null?void 0:n.payrolls)==null?void 0:d.filter(t=>{const i=new Date(t.paidAt||t.createdAt);return i.getMonth()===r&&i.getFullYear()===x}))||[];a.push({month:s[r],amount:c.reduce((t,i)=>t+Number(i.netSalary),0),count:c.length})}return a},I=()=>{const s=["BANK_TRANSFER","CASH","CHECK","MOBILE_MONEY","CRYPTOCURRENCY","OTHER"],a=[];return s.forEach(n=>{var r,c,t,i;const d=((c=(r=l==null?void 0:l.data)==null?void 0:r.payrolls)==null?void 0:c.filter(m=>m.paymentMethod===n))||[];a.push({method:n.replace("_"," "),amount:d.reduce((m,j)=>m+Number(j.netSalary),0),count:d.length,percentage:(i=(t=l==null?void 0:l.data)==null?void 0:t.payrolls)!=null&&i.length?d.length/l.data.payrolls.length*100:0})}),a.filter(n=>n.count>0)},_=()=>{var a,n;return[...new Set(((n=(a=l==null?void 0:l.data)==null?void 0:a.payrolls)==null?void 0:n.map(d=>{var r;return((r=d.employee)==null?void 0:r.department)||"Unknown"}))||[])].map(d=>{var c,t;const r=((t=(c=l==null?void 0:l.data)==null?void 0:c.payrolls)==null?void 0:t.filter(i=>{var m;return(((m=i.employee)==null?void 0:m.department)||"Unknown")===d}))||[];return{department:d,amount:r.reduce((i,m)=>i+Number(m.netSalary),0),count:r.length,average:r.length>0?r.reduce((i,m)=>i+Number(m.netSalary),0)/r.length:0}}).sort((d,r)=>r.amount-d.amount)},w=s=>{switch(s){case"BANK_TRANSFER":return e.jsx(ne,{className:"w-4 h-4"});case"CASH":return e.jsx(le,{className:"w-4 h-4"});case"CHECK":return e.jsx(re,{className:"w-4 h-4"});case"MOBILE_MONEY":return e.jsx(ae,{className:"w-4 h-4"});case"CRYPTOCURRENCY":return e.jsx(te,{className:"w-4 h-4"});default:return e.jsx(se,{className:"w-4 h-4"})}},h=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s),H=()=>{var c;if(!((c=l==null?void 0:l.data)!=null&&c.payrolls)){k.error("No data to export");return}const s=l.data.payrolls.map(t=>{var i,m,j,P,R,E;return{"Employee Name":`${(m=(i=t.employee)==null?void 0:i.user)==null?void 0:m.firstName} ${(P=(j=t.employee)==null?void 0:j.user)==null?void 0:P.lastName}`,"Employee ID":(R=t.employee)==null?void 0:R.employeeId,Department:((E=t.employee)==null?void 0:E.department)||"N/A",Month:t.month,Year:t.year,"Basic Salary":t.basicSalary,"Overtime Pay":t.overtimePay,Allowances:t.allowances,Deductions:t.deductions,"Net Salary":t.netSalary,"Payment Method":t.paymentMethod||"N/A","Payment Reference":t.paymentReference||"N/A","Paid Date":t.paidAt?new Date(t.paidAt).toLocaleDateString():"N/A",Status:t.status}}),a=[Object.keys(s[0]).join(","),...s.map(t=>Object.values(t).join(","))].join(`
`),n=new Blob([a],{type:"text/csv"}),d=window.URL.createObjectURL(n),r=document.createElement("a");r.href=d,r.download=`payment-report-${x}${o?`-${o}`:""}.csv`,r.click(),window.URL.revokeObjectURL(d),k.success("Payment report exported successfully!")},g=F(),$=I(),K=_();return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-600 to-green-700 rounded-lg shadow-lg p-6 text-white",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Payment Reports"}),e.jsx("p",{className:"text-green-100 mt-2",children:"Comprehensive salary payment analytics and insights"})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:H,className:"bg-white text-green-600 px-6 py-3 rounded-lg font-semibold hover:bg-green-50 transition-colors flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"Export CSV"]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Year"}),e.jsx("select",{value:x,onChange:s=>O(Number(s.target.value)),className:"input",children:Array.from({length:5},(s,a)=>new Date().getFullYear()-a).map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Month"}),e.jsxs("select",{value:o,onChange:s=>T(s.target.value),className:"input",children:[e.jsx("option",{value:"",children:"All Months"}),Array.from({length:12},(s,a)=>a+1).map(s=>e.jsx("option",{value:s,children:new Date(0,s-1).toLocaleString("default",{month:"long"})},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employee"}),e.jsxs("select",{value:v,onChange:s=>Y(s.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"All Employees"}),(C=(A=N==null?void 0:N.data)==null?void 0:A.employees)==null?void 0:C.map(s=>e.jsxs("option",{value:s.id,children:[s.user.firstName," ",s.user.lastName]},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Method"}),e.jsxs("select",{value:b,onChange:s=>L(s.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"All Methods"}),e.jsx("option",{value:"BANK_TRANSFER",children:"Bank Transfer"}),e.jsx("option",{value:"CASH",children:"Cash"}),e.jsx("option",{value:"CHECK",children:"Check"}),e.jsx("option",{value:"MOBILE_MONEY",children:"Mobile Money"}),e.jsx("option",{value:"CRYPTOCURRENCY",children:"Cryptocurrency"}),e.jsx("option",{value:"OTHER",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Report Type"}),e.jsxs("select",{value:f,onChange:s=>U(s.target.value),className:"input",children:[e.jsx("option",{value:"summary",children:"Summary"}),e.jsx("option",{value:"detailed",children:"Detailed"}),e.jsx("option",{value:"analytics",children:"Analytics"})]})]})]})}),p&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Payments"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:p.totalPayrolls})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(V,{className:"h-6 w-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Paid Amount"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:h(Number(p.totalAmountPaid))})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(Q,{className:"h-6 w-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Amount"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:h(Number(p.totalAmountPending))})]}),e.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:e.jsx(q,{className:"h-6 w-6 text-orange-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Payment Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[p.paymentRate.toFixed(1),"%"]})]}),e.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:e.jsx(G,{className:"h-6 w-6 text-purple-600"})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"Monthly Payment Trends"]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-4",children:"Payment Amounts by Month"}),e.jsx("div",{className:"space-y-3",children:g.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:s.month}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.max(5,s.amount/Math.max(...g.map(n=>n.amount))*100)}%`}})}),e.jsx("span",{className:"text-sm font-medium text-gray-900 w-20 text-right",children:h(s.amount)})]})]},a))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-4",children:"Payment Counts by Month"}),e.jsx("div",{className:"space-y-3",children:g.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:s.month}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${Math.max(5,s.count/Math.max(...g.map(n=>n.count))*100)}%`}})}),e.jsx("span",{className:"text-sm font-medium text-gray-900 w-12 text-right",children:s.count})]})]},a))})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5"}),"Payment Method Analysis"]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:$.map((s,a)=>e.jsxs("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[w(s.method.replace(" ","_")),e.jsx("span",{className:"font-medium text-gray-900",children:s.method})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[s.count," payments"]})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-1",children:h(s.amount)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[s.percentage.toFixed(1),"% of total payments"]})]},a))})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5"}),"Department Payment Analysis"]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment Count"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Average Payment"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:K.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.department}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h(s.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.count}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h(s.average)})]},a))})]})})})]}),f==="detailed"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5"}),"Detailed Payment Records"]})}),e.jsx("div",{className:"p-6",children:B?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Loading payment data..."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment Method"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reference"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Paid Date"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(M=(S=l==null?void 0:l.data)==null?void 0:S.payrolls)==null?void 0:M.map(s=>{var a,n,d,r,c,t;return e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[(n=(a=s.employee)==null?void 0:a.user)==null?void 0:n.firstName," ",(r=(d=s.employee)==null?void 0:d.user)==null?void 0:r.lastName]}),e.jsx("div",{className:"text-sm text-gray-500",children:(c=s.employee)==null?void 0:c.employeeId})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:h(Number(s.netSalary))}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[w(s.paymentMethod),e.jsx("span",{className:"text-sm text-gray-900",children:((t=s.paymentMethod)==null?void 0:t.replace("_"," "))||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.paymentReference||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.paidAt?new Date(s.paidAt).toLocaleDateString():"N/A"})]},s.id)})})]})})})]})]})};export{ue as default};
//# sourceMappingURL=PaymentReports-UkCLkK9N.js.map
