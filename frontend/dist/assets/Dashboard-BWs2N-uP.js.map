{"version":3,"file":"Dashboard-BWs2N-uP.js","sources":["../../src/utils/locationTracker.ts","../../src/pages/Dashboard.tsx"],"sourcesContent":["import { locationTrackingService, LocationTrackingRequest } from '../services/locationTrackingService'\r\nimport { getCompleteLocation } from './geolocation'\r\n\r\nexport class LocationTracker {\r\n  private intervalId: number | null = null\r\n  private attendanceId: string | null = null\r\n  private isTracking: boolean = false\r\n  private trackingInterval: number = 30000 // 30 seconds default\r\n\r\n  constructor(intervalMs: number = 30000) {\r\n    this.trackingInterval = intervalMs\r\n  }\r\n\r\n  // Start continuous location tracking\r\n  async startTracking(attendanceId: string): Promise<void> {\r\n    if (this.isTracking) {\r\n      console.log('Location tracking already active')\r\n      return\r\n    }\r\n\r\n    this.attendanceId = attendanceId\r\n    this.isTracking = true\r\n\r\n    console.log('üöÄ Starting location tracking for attendance:', attendanceId)\r\n\r\n    // Track location immediately\r\n    await this.trackCurrentLocation()\r\n\r\n    // Set up interval for continuous tracking\r\n    this.intervalId = setInterval(async () => {\r\n      if (this.isTracking && this.attendanceId) {\r\n        await this.trackCurrentLocation()\r\n      }\r\n    }, this.trackingInterval)\r\n  }\r\n\r\n  // Stop location tracking\r\n  async stopTracking(): Promise<void> {\r\n    if (!this.isTracking || !this.attendanceId) {\r\n      console.log('No active tracking to stop')\r\n      return\r\n    }\r\n\r\n    console.log('üõë Stopping location tracking for attendance:', this.attendanceId)\r\n\r\n    // Clear interval\r\n    if (this.intervalId) {\r\n      clearInterval(this.intervalId)\r\n      this.intervalId = null\r\n    }\r\n\r\n    // Stop tracking on server\r\n    try {\r\n      await locationTrackingService.stopTracking(this.attendanceId)\r\n      console.log('‚úÖ Location tracking stopped successfully')\r\n    } catch (error) {\r\n      console.error('‚ùå Error stopping location tracking:', error)\r\n    }\r\n\r\n    // Reset state\r\n    this.isTracking = false\r\n    this.attendanceId = null\r\n  }\r\n\r\n  // Track current location\r\n  private async trackCurrentLocation(): Promise<void> {\r\n    if (!this.attendanceId) return\r\n\r\n    try {\r\n      // Get current location\r\n      const location = await getCompleteLocation()\r\n      \r\n      const trackingData: LocationTrackingRequest = {\r\n        attendanceId: this.attendanceId,\r\n        latitude: location.latitude,\r\n        longitude: location.longitude,\r\n        accuracy: location.accuracy,\r\n        address: location.address\r\n      }\r\n\r\n      // Send to server\r\n      await locationTrackingService.trackLocation(trackingData)\r\n      console.log('üìç Location tracked:', {\r\n        lat: location.latitude,\r\n        lng: location.longitude,\r\n        address: location.address,\r\n        timestamp: new Date().toISOString()\r\n      })\r\n\r\n    } catch (error) {\r\n      console.error('‚ùå Error tracking location:', error)\r\n    }\r\n  }\r\n\r\n  // Get tracking status\r\n  getStatus(): { isTracking: boolean; attendanceId: string | null } {\r\n    return {\r\n      isTracking: this.isTracking,\r\n      attendanceId: this.attendanceId\r\n    }\r\n  }\r\n\r\n  // Update tracking interval\r\n  setInterval(intervalMs: number): void {\r\n    this.trackingInterval = intervalMs\r\n    \r\n    // If currently tracking, restart with new interval\r\n    if (this.isTracking && this.intervalId) {\r\n      clearInterval(this.intervalId)\r\n      this.intervalId = setInterval(async () => {\r\n        if (this.isTracking && this.attendanceId) {\r\n          await this.trackCurrentLocation()\r\n        }\r\n      }, this.trackingInterval)\r\n    }\r\n  }\r\n}\r\n\r\n// Create a singleton instance\r\nexport const locationTracker = new LocationTracker()\r\n","import React, { useState } from 'react'\nimport { useAuth } from '../hooks/useAuth'\nimport { useNavigate } from 'react-router-dom'\nimport { useQuery, useMutation, useQueryClient } from 'react-query'\nimport { attendanceService } from '../services/attendanceService'\nimport { leaveService } from '../services/leaveService'\nimport { employeeService } from '../services/employeeService'\nimport { Clock, X, MapPin, Camera } from 'lucide-react'\nimport toast from 'react-hot-toast'\nimport { getCompleteLocation, getDeviceInfo } from '../utils/geolocation'\nimport { captureSelfie, compressImage, checkCameraPermissions } from '../utils/camera'\nimport { locationTracker } from '../utils/locationTracker'\n\nconst Dashboard: React.FC = () => {\n  const { user } = useAuth()\n  const navigate = useNavigate()\n  const [showSelfAttendanceModal, setShowSelfAttendanceModal] = useState(false)\n  const [location, setLocation] = useState<any>(null)\n  const [selfie, setSelfie] = useState<string | null>(null)\n  const [isAutoCapturing, setIsAutoCapturing] = useState(false)\n  const queryClient = useQueryClient()\n  \n  // Fetch data based on user role with better error handling\n  const { data: attendanceData, error: attendanceError } = useQuery(\n    'my-attendance',\n    () => attendanceService.getAttendance({ employeeId: user?.employeeId }),\n    { \n      enabled: !!user?.employeeId,\n      retry: 2,\n      retryDelay: 1000,\n      onError: (error: any) => {\n        if (error.code !== 'NETWORK_ERROR') {\n          console.error('Attendance data fetch error:', error)\n        }\n      }\n    }\n  )\n  \n  const { data: leaveData, error: leaveError } = useQuery(\n    'my-leave-requests',\n    () => leaveService.getLeaveRequests({ employeeId: user?.employeeId }),\n    { \n      enabled: !!user?.employeeId,\n      retry: 2,\n      retryDelay: 1000,\n      onError: (error: any) => {\n        if (error.code !== 'NETWORK_ERROR') {\n          console.error('Leave data fetch error:', error)\n        }\n      }\n    }\n  )\n  \n  const { data: employeeStats, error: employeeStatsError } = useQuery(\n    'employee-stats',\n    () => employeeService.getEmployeeStats(),\n    { \n      enabled: user?.role === 'SUPER_ADMIN' || user?.role === 'HR_MANAGER',\n      retry: 2,\n      retryDelay: 1000,\n      onError: (error: any) => {\n        if (error.code !== 'NETWORK_ERROR') {\n          console.error('Employee stats fetch error:', error)\n        }\n      }\n    }\n  )\n  \n  const { data: attendanceStats, error: attendanceStatsError } = useQuery(\n    'attendance-stats',\n    () => attendanceService.getAttendanceStats(),\n    { \n      enabled: user?.role === 'SUPER_ADMIN' || user?.role === 'HR_MANAGER',\n      retry: 2,\n      retryDelay: 1000,\n      onError: (error: any) => {\n        if (error.code !== 'NETWORK_ERROR') {\n          console.error('Attendance stats fetch error:', error)\n        }\n      }\n    }\n  )\n  \n  const { data: leaveStats, error: leaveStatsError } = useQuery(\n    'leave-stats',\n    () => leaveService.getLeaveStats(),\n    { \n      enabled: user?.role === 'SUPER_ADMIN' || user?.role === 'HR_MANAGER',\n      retry: 2,\n      retryDelay: 1000,\n      onError: (error: any) => {\n        if (error.code !== 'NETWORK_ERROR') {\n          console.error('Leave stats fetch error:', error)\n        }\n      }\n    }\n  )\n\n  // Self check-in mutation\n  const selfCheckInMutation = useMutation(\n    attendanceService.selfCheckIn,\n    {\n      onSuccess: (data) => {\n        queryClient.invalidateQueries('my-attendance')\n        queryClient.invalidateQueries('attendance-status')\n        \n        // Start location tracking after successful check-in\n        if (data?.id) {\n          locationTracker.startTracking(data.id)\n          console.log('üöÄ Location tracking started for attendance:', data.id)\n        }\n        \n        toast.success('‚úÖ Check-in completed successfully! Location tracking started.')\n        setShowSelfAttendanceModal(false)\n        setLocation(null)\n        setSelfie(null)\n      },\n      onError: (error: any) => {\n        const errorMessage = error.response?.data?.error || 'Failed to check in'\n        if (errorMessage.includes('already marked')) {\n          toast.error('You have already checked in today. Please check out first.')\n        } else if (errorMessage.includes('Already completed attendance')) {\n          toast.error('Attendance already completed for today')\n        } else {\n          toast.error(errorMessage)\n        }\n      }\n    }\n  )\n\n  // Self check-out mutation\n  const selfCheckOutMutation = useMutation(\n    attendanceService.selfCheckOut,\n    {\n      onSuccess: () => {\n        queryClient.invalidateQueries('my-attendance')\n        queryClient.invalidateQueries('attendance-status')\n        \n        // Stop location tracking after successful check-out\n        locationTracker.stopTracking()\n        console.log('üõë Location tracking stopped after check-out')\n        \n        toast.success('‚úÖ Check-out completed successfully! Location tracking stopped.')\n        setShowSelfAttendanceModal(false)\n        setLocation(null)\n        setSelfie(null)\n      },\n      onError: (error: any) => {\n        const errorMessage = error.response?.data?.error || 'Failed to check out'\n        if (errorMessage.includes('No active check-in')) {\n          toast.error('Please check in first before checking out')\n        } else if (errorMessage.includes('Already checked out')) {\n          toast.error('You have already checked out today')\n        } else {\n          toast.error(errorMessage)\n        }\n      }\n    }\n  )\n\n  // Get current attendance status\n  const { data: attendanceStatus } = useQuery(\n    'attendance-status',\n    () => attendanceService.getAttendanceStatus(),\n    {\n      enabled: !!user?.employeeId,\n      refetchInterval: 30000, // Refetch every 30 seconds\n      refetchOnWindowFocus: true\n    }\n  )\n\n  // Manual selfie and GPS capture\n  const handleTakeSelfieAndLocation = async () => {\n    setIsAutoCapturing(true)\n    \n    // Check camera permissions first\n    try {\n      const permissionCheck = await checkCameraPermissions()\n      if (!permissionCheck.hasPermission) {\n        toast.error(permissionCheck.message)\n        setIsAutoCapturing(false)\n        return\n      }\n    } catch (error: any) {\n      console.error('‚ùå Camera permission check failed:', error)\n      toast.error('Failed to check camera permissions. Please try again.')\n      setIsAutoCapturing(false)\n      return\n    }\n\n    // Capture selfie\n    try {\n      const photo = await captureSelfie()\n      const compressed = await compressImage(photo)\n      setSelfie(compressed)\n      console.log('üì∏ Selfie captured and set:', {\n        hasSelfie: !!compressed,\n        selfieLength: compressed?.length || 0\n      })\n      toast.success('üì∏ Selfie captured successfully!')\n    } catch (error: any) {\n      console.error('‚ùå Selfie capture failed:', error)\n      toast.error(error.message || 'Failed to capture selfie')\n      setIsAutoCapturing(false)\n      return\n    }\n\n    // Capture GPS location\n    try {\n      const loc = await getCompleteLocation()\n      setLocation(loc)\n      console.log('üìç Location captured and set:', {\n        hasLocation: !!loc,\n        locationData: loc\n      })\n      toast.success('üìç Location captured successfully!')\n    } catch (error: any) {\n      console.log('‚ùå Location capture failed:', error)\n      toast.error(error.message || 'Failed to get location')\n      setIsAutoCapturing(false)\n      return\n    }\n\n    setIsAutoCapturing(false)\n    \n    // Verify both selfie and location are captured before proceeding\n    if (!selfie || !location) {\n      console.error('‚ùå Missing data for submission:', { hasSelfie: !!selfie, hasLocation: !!location })\n      toast.error('Failed to capture required data. Please try again.')\n      return\n    }\n    \n    // Automatically submit attendance after capturing selfie and location\n    setTimeout(() => {\n      handleAutoSubmitAttendance()\n    }, 1000) // Small delay to ensure all data is captured\n  }\n\n  const handleAutoSubmitAttendance = () => {\n    // Get device info\n    const deviceInfo = getDeviceInfo()\n    \n    // Debug current state\n    console.log('üîç Auto-submit state check:', {\n      hasSelfie: !!selfie,\n      selfieLength: selfie?.length || 0,\n      hasLocation: !!location,\n      locationData: location,\n      attendanceStatus: attendanceStatus?.status\n    })\n    \n    // Determine if this is check-in or check-out based on current status\n    const isCheckOut = attendanceStatus?.status?.canCheckOut\n    \n    if (isCheckOut) {\n      // Check-out flow\n      const checkOutData = {\n        notes: undefined, // No notes field\n        checkOutSelfie: selfie || undefined,\n        checkOutLocation: location || undefined\n      }\n      \n      // Debug logging\n      console.log('üîç Check-out data being sent:', {\n        hasSelfie: !!selfie,\n        selfieLength: selfie?.length || 0,\n        selfiePreview: selfie?.substring(0, 50) + '...',\n        hasLocation: !!location,\n        locationData: location,\n        checkOutData,\n        fullPayload: {\n          notes: undefined,\n          checkOutSelfie: selfie || undefined,\n          checkOutLocation: location || undefined\n        }\n      })\n      \n      toast.loading('üéØ Automatically checking out...', { duration: 2000 })\n      selfCheckOutMutation.mutate(checkOutData)\n    } else {\n      // Check-in flow\n      const checkInData = {\n        isRemote: false, // Default to false, no user input needed\n        notes: undefined, // No notes field\n        checkInSelfie: selfie || undefined,\n        checkInLocation: location || undefined,\n        deviceInfo: deviceInfo || undefined,\n        shiftId: null\n      }\n      \n      // Debug logging\n      console.log('üîç Check-in data being sent:', {\n        hasSelfie: !!selfie,\n        selfieLength: selfie?.length || 0,\n        selfiePreview: selfie?.substring(0, 50) + '...',\n        hasLocation: !!location,\n        locationData: location,\n        checkInData,\n        fullPayload: {\n          isRemote: false,\n          notes: undefined,\n          checkInSelfie: selfie || undefined,\n          checkInLocation: location || undefined,\n          deviceInfo: deviceInfo || undefined,\n          shiftId: null\n        }\n      })\n      \n      toast.loading('üéØ Automatically checking in...', { duration: 2000 })\n      selfCheckInMutation.mutate(checkInData)\n    }\n  }\n\n\n  // Check if user is admin/HR\n  const isAdmin = user?.role === 'SUPER_ADMIN' || user?.role === 'HR_MANAGER'\n  \n  return (\n    <div className=\"p-6\">\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-4\">\n          üéâ Dashboard Loaded Successfully!\n        </h1>\n        <p className=\"text-gray-600 mb-6\">\n          Welcome to the Employee Attendance System Dashboard\n        </p>\n        \n        {/* Role-based content */}\n        {isAdmin ? (\n          // Admin/HR Dashboard\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n            <div className=\"bg-blue-50 p-4 rounded-lg\">\n              <h3 className=\"font-semibold text-blue-900\">Total Employees</h3>\n              <p className=\"text-2xl font-bold text-blue-600\">\n                {employeeStats?.totalEmployees || 0}\n              </p>\n            </div>\n            <div className=\"bg-green-50 p-4 rounded-lg\">\n              <h3 className=\"font-semibold text-green-900\">Active Today</h3>\n              <p className=\"text-2xl font-bold text-green-600\">\n                {attendanceStats?.presentCount || 0}\n              </p>\n            </div>\n            <div className=\"bg-purple-50 p-4 rounded-lg\">\n              <h3 className=\"font-semibold text-purple-900\">Pending Leaves</h3>\n              <p className=\"text-2xl font-bold text-purple-600\">\n                {leaveStats?.pendingRequests || 0}\n              </p>\n            </div>\n          </div>\n        ) : (\n          // Employee Dashboard\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n            <div className=\"bg-blue-50 p-4 rounded-lg\">\n              <h3 className=\"font-semibold text-blue-900\">My Attendance</h3>\n              <p className=\"text-2xl font-bold text-blue-600\">\n                {attendanceData?.data?.attendances?.length || 0}\n              </p>\n            </div>\n            <div className=\"bg-green-50 p-4 rounded-lg\">\n              <h3 className=\"font-semibold text-green-900\">My Leave Requests</h3>\n              <p className=\"text-2xl font-bold text-green-600\">\n                {leaveData?.data?.leaveRequests?.length || 0}\n              </p>\n            </div>\n            <div className=\"bg-purple-50 p-4 rounded-lg\">\n              <h3 className=\"font-semibold text-purple-900\">Pending Leaves</h3>\n              <p className=\"text-2xl font-bold text-purple-600\">\n                {leaveData?.data?.leaveRequests?.filter((leave: any) => leave.status === 'PENDING').length || 0}\n              </p>\n            </div>\n          </div>\n        )}\n        \n        <div className=\"mt-8\">\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">Quick Actions</h2>\n          <div className=\"space-y-2\">\n            {isAdmin ? (\n              // Admin actions\n              <>\n                <button \n                  onClick={() => navigate('/attendance')}\n                  className=\"w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition-colors cursor-pointer\"\n                >\n                  Mark Attendance\n                </button>\n                <button \n                  onClick={() => navigate('/employees')}\n                  className=\"w-full bg-gray-200 text-gray-800 py-2 px-4 rounded hover:bg-gray-300 transition-colors cursor-pointer\"\n                >\n                  View Employees\n                </button>\n                <button \n                  onClick={() => navigate('/leave-requests')}\n                  className=\"w-full bg-gray-200 text-gray-800 py-2 px-4 rounded hover:bg-gray-300 transition-colors cursor-pointer\"\n                >\n                  Manage Leave Requests\n                </button>\n                {user?.role === 'SUPER_ADMIN' && (\n                  <>\n                    <button \n                      onClick={() => navigate('/employees')}\n                      className=\"w-full bg-purple-600 text-white py-2 px-4 rounded hover:bg-purple-700 transition-colors cursor-pointer\"\n                    >\n                      User & Role Management\n                    </button>\n                    <button \n                      onClick={() => navigate('/shifts')}\n                      className=\"w-full bg-orange-600 text-white py-2 px-4 rounded hover:bg-orange-700 transition-colors cursor-pointer\"\n                    >\n                      Shift Management\n                    </button>\n                    <button \n                      onClick={() => navigate('/settings')}\n                      className=\"w-full bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700 transition-colors cursor-pointer\"\n                    >\n                      System Settings\n                    </button>\n                  </>\n                )}\n              </>\n            ) : (\n              // Employee actions\n              <>\n                <button \n                  onClick={() => setShowSelfAttendanceModal(true)}\n                  className=\"w-full bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700 transition-colors cursor-pointer\"\n                >\n                  Mark Self Attendance\n                </button>\n                <button \n                  onClick={() => navigate('/my-attendance')}\n                  className=\"w-full bg-gray-200 text-gray-800 py-2 px-4 rounded hover:bg-gray-300 transition-colors cursor-pointer\"\n                >\n                  View My Attendance\n                </button>\n                <button \n                  onClick={() => navigate('/my-leave')}\n                  className=\"w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition-colors cursor-pointer\"\n                >\n                  Request Leave\n                </button>\n                <button \n                  onClick={() => navigate('/profile')}\n                  className=\"w-full bg-gray-200 text-gray-800 py-2 px-4 rounded hover:bg-gray-300 transition-colors cursor-pointer\"\n                >\n                  View My Profile\n                </button>\n              </>\n            )}\n          </div>\n        </div>\n        \n        {/* Super Admin Features */}\n        {user?.role === 'SUPER_ADMIN' && (\n          <div className=\"mt-8\">\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">Super Admin Features</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              <div className=\"bg-purple-50 p-4 rounded-lg border border-purple-200\">\n                <h3 className=\"font-semibold text-purple-900 mb-2\">User Management</h3>\n                <p className=\"text-sm text-purple-700 mb-3\">Manage employees and users</p>\n                <button \n                  onClick={() => navigate('/employees')}\n                  className=\"w-full bg-purple-600 text-white py-2 px-4 rounded hover:bg-purple-700 text-sm transition-colors cursor-pointer\"\n                >\n                  Manage Employees\n                </button>\n              </div>\n              \n              <div className=\"bg-orange-50 p-4 rounded-lg border border-orange-200\">\n                <h3 className=\"font-semibold text-orange-900 mb-2\">Shift Management</h3>\n                <p className=\"text-sm text-orange-700 mb-3\">Create and manage work shifts</p>\n                <button \n                  onClick={() => navigate('/shifts')}\n                  className=\"w-full bg-orange-600 text-white py-2 px-4 rounded hover:bg-orange-700 text-sm transition-colors cursor-pointer\"\n                >\n                  Manage Shifts\n                </button>\n              </div>\n              \n              <div className=\"bg-red-50 p-4 rounded-lg border border-red-200\">\n                <h3 className=\"font-semibold text-red-900 mb-2\">System Settings</h3>\n                <p className=\"text-sm text-red-700 mb-3\">Configure system-wide settings</p>\n                <button \n                  onClick={() => navigate('/settings')}\n                  className=\"w-full bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700 text-sm transition-colors cursor-pointer\"\n                >\n                  System Config\n                </button>\n              </div>\n              \n              <div className=\"bg-indigo-50 p-4 rounded-lg border border-indigo-200\">\n                <h3 className=\"font-semibold text-indigo-900 mb-2\">Payroll Management</h3>\n                <p className=\"text-sm text-indigo-700 mb-3\">Manage employee salaries</p>\n                <button \n                  onClick={() => navigate('/payroll')}\n                  className=\"w-full bg-indigo-600 text-white py-2 px-4 rounded hover:bg-indigo-700 text-sm transition-colors cursor-pointer\"\n                >\n                  Manage Payroll\n                </button>\n              </div>\n              \n              <div className=\"bg-teal-50 p-4 rounded-lg border border-teal-200\">\n                <h3 className=\"font-semibold text-teal-900 mb-2\">Attendance Reports</h3>\n                <p className=\"text-sm text-teal-700 mb-3\">View attendance analytics</p>\n                <button \n                  onClick={() => navigate('/attendance')}\n                  className=\"w-full bg-teal-600 text-white py-2 px-4 rounded hover:bg-teal-700 text-sm transition-colors cursor-pointer\"\n                >\n                  View Attendance\n                </button>\n              </div>\n              \n              <div className=\"bg-pink-50 p-4 rounded-lg border border-pink-200\">\n                <h3 className=\"font-semibold text-pink-900 mb-2\">Leave Management</h3>\n                <p className=\"text-sm text-pink-700 mb-3\">Manage leave requests</p>\n                <button \n                  onClick={() => navigate('/leave')}\n                  className=\"w-full bg-pink-600 text-white py-2 px-4 rounded hover:bg-pink-700 text-sm transition-colors cursor-pointer\"\n                >\n                  Manage Leaves\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n        \n        <div className=\"mt-8 p-4 bg-green-50 rounded-lg\">\n          <h3 className=\"font-semibold text-green-900\">System Status</h3>\n          <p className=\"text-green-700\">‚úÖ All systems operational</p>\n          {(attendanceError || leaveError || employeeStatsError || attendanceStatsError || leaveStatsError) && (\n            <div className=\"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded\">\n              <p className=\"text-yellow-800 text-sm\">\n                ‚ö†Ô∏è Some data may not be up to date due to network issues. Please refresh the page.\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Self-Attendance Modal */}\n      {showSelfAttendanceModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-lg shadow-lg w-full max-w-lg mx-auto max-h-[95vh] overflow-y-auto\">\n            <div className=\"flex items-center justify-between p-6 border-b sticky top-0 bg-white z-10\">\n              <h2 className=\"text-xl font-semibold text-gray-900 flex items-center\">\n                <Clock className=\"w-5 h-5 mr-2\" />\n                Mark Attendance\n              </h2>\n              <button\n                onClick={() => {\n                  setShowSelfAttendanceModal(false)\n                  setSelfie(null)\n                  setLocation(null)\n                }}\n                className=\"text-gray-400 hover:text-gray-600\"\n              >\n                <X className=\"w-5 h-5\" />\n              </button>\n            </div>\n\n            <div className=\"p-6 space-y-4\">\n              {/* Automatic Data Capture Notice */}\n              <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                <div className=\"flex items-center gap-2 mb-2\">\n                  <Clock className=\"h-5 w-5 text-blue-600\" />\n                  <span className=\"font-medium text-blue-800\">Automatic Data Capture</span>\n                </div>\n                <p className=\"text-sm text-blue-700\">\n                  Date, time, and status will be automatically captured when you take your selfie.\n                </p>\n              </div>\n\n              {/* Phase 2: Selfie & Location Capture */}\n              {!selfie && !location ? (\n                <div className=\"p-8 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 border-2 border-blue-400 rounded-xl shadow-md\">\n                  <div className=\"text-center mb-6\">\n                    <div className=\"bg-blue-600 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg\">\n                      <Camera className=\"w-10 h-10 text-white\" />\n                    </div>\n                    <h3 className=\"text-2xl font-bold text-gray-900 mb-2\">\n                      üì∏ {attendanceStatus?.status?.canCheckOut ? 'Check-Out Selfie' : 'Check-In Selfie'}\n                    </h3>\n                    <p className=\"text-base text-gray-700\">\n                      {attendanceStatus?.status?.canCheckOut ? 'üåÜ Take your check-out selfie' : 'üåÖ Take your check-in selfie'}\n                    </p>\n                    <p className=\"text-sm text-gray-600 mt-2\">\n                      Selfie + location will be automatically captured and {attendanceStatus?.status?.canCheckOut ? 'check-out' : 'check-in'} will be marked\n                    </p>\n                  </div>\n                  <button\n                    type=\"button\"\n                    onClick={handleTakeSelfieAndLocation}\n                    disabled={isAutoCapturing}\n                    className=\"w-full flex items-center justify-center gap-3 px-8 py-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white text-xl font-bold rounded-xl hover:from-blue-700 hover:to-blue-800 disabled:opacity-50 disabled:cursor-not-allowed shadow-xl transform transition hover:scale-105\"\n                  >\n                    {isAutoCapturing ? (\n                      <>\n                        <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-white\"></div>\n                        Opening Camera...\n                      </>\n                    ) : (\n                      <>\n                        <Camera className=\"w-6 h-6\" />\n                        üì∏ {attendanceStatus?.status?.canCheckOut ? 'Take Check-Out Selfie' : 'Take Check-In Selfie'}\n                      </>\n                    )}\n                  </button>\n                  <p className=\"text-xs text-gray-600 mt-4 text-center bg-white/50 p-3 rounded-lg\">\n                    ‚ÑπÔ∏è Camera and location permissions will be requested\n                  </p>\n                </div>\n              ) : (\n                <>\n                  {/* Show captured selfie */}\n                  {selfie && (\n                    <div>\n                      <label className=\"label text-lg font-semibold\">\n                        üì∏ Attendance Selfie ‚úÖ\n                      </label>\n                      <div className=\"relative\">\n                        <img \n                          src={selfie} \n                          alt=\"Attendance Selfie\" \n                          className=\"w-full h-80 object-cover rounded-xl border-4 border-green-500 shadow-lg\"\n                        />\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setSelfie(null)\n                            setLocation(null)\n                          }}\n                          className=\"absolute top-3 right-3 bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 flex items-center gap-2 shadow-lg\"\n                        >\n                          <Camera className=\"w-5 h-5\" />\n                          Retake\n                        </button>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Show captured location */}\n                  {location && (\n                    <div>\n                      <label className=\"label\">Your Location ‚úÖ</label>\n                      <div className=\"p-3 bg-green-50 border border-green-200 rounded\">\n                        <div className=\"flex items-center gap-2\">\n                          <MapPin className=\"w-4 h-4 text-green-600\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-green-900\">\n                              {location.address || `${location.latitude.toFixed(6)}, ${location.longitude.toFixed(6)}`}\n                            </p>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </>\n              )}\n\n              {/* Show confirmation only after selfie is captured */}\n              {selfie && location && (\n                <>\n                  {/* Automatic time capture notice */}\n                  <div className=\"p-3 bg-green-50 rounded-lg border border-green-200\">\n                    <div className=\"flex items-center gap-2\">\n                      <Clock className=\"h-4 w-4 text-green-600\" />\n                      <span className=\"text-sm font-medium text-green-800\">Time will be automatically captured</span>\n                    </div>\n                    <p className=\"text-xs text-green-700 mt-1\">\n                      Current time will be used for check-in/check-out\n                    </p>\n                  </div>\n\n                  {/* Info Badge */}\n                  <div className=\"p-2 bg-blue-50 border border-blue-200 rounded text-center\">\n                    <p className=\"text-xs text-blue-700\">\n                      ‚úÖ Selfie, Location, Device & IP captured\n                    </p>\n                  </div>\n                </>\n              )}\n              \n              <div className=\"flex space-x-3 pt-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setShowSelfAttendanceModal(false)}\n                  className=\"flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded hover:bg-gray-300\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={async () => {\n                    try {\n                      const permissionCheck = await checkCameraPermissions()\n                      if (permissionCheck.hasPermission) {\n                        toast.success('‚úÖ Camera is working perfectly!')\n                      } else {\n                        toast.error(permissionCheck.message)\n                      }\n                    } catch (error: any) {\n                      toast.error('Camera test failed: ' + error.message)\n                    }\n                  }}\n                  className=\"bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition-colors mr-2\"\n                >\n                  Test Camera\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={handleTakeSelfieAndLocation}\n                  disabled={isAutoCapturing || selfCheckInMutation.isLoading || selfCheckOutMutation.isLoading}\n                  className=\"flex-1 bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700 disabled:opacity-50\"\n                >\n                  {isAutoCapturing ? 'Capturing...' : \n                   selfCheckInMutation.isLoading ? 'Checking In...' :\n                   selfCheckOutMutation.isLoading ? 'Checking Out...' :\n                   'Take Selfie & Mark Attendance'}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport default Dashboard\n"],"names":["LocationTracker","intervalMs","__publicField","attendanceId","locationTrackingService","error","location","getCompleteLocation","trackingData","locationTracker","Dashboard","user","useAuth","navigate","useNavigate","showSelfAttendanceModal","setShowSelfAttendanceModal","useState","setLocation","selfie","setSelfie","isAutoCapturing","setIsAutoCapturing","queryClient","useQueryClient","attendanceData","attendanceError","useQuery","attendanceService","leaveData","leaveError","leaveService","employeeStats","employeeStatsError","employeeService","attendanceStats","attendanceStatsError","leaveStats","leaveStatsError","selfCheckInMutation","useMutation","data","toast","errorMessage","_b","_a","selfCheckOutMutation","attendanceStatus","handleTakeSelfieAndLocation","permissionCheck","checkCameraPermissions","photo","captureSelfie","compressed","compressImage","loc","handleAutoSubmitAttendance","deviceInfo","getDeviceInfo","checkOutData","checkInData","isAdmin","jsxs","jsx","leave","Fragment","Clock","X","Camera","_g","_i","_j","MapPin"],"mappings":"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"}