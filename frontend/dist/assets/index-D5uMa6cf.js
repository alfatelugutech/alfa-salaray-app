const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-Xq8SfIHd.js","assets/router-BXhMSvr3.js","assets/vendor-C8w-UNLI.js","assets/ui-I5zzr6O5.js","assets/query-DSXC375t.js","assets/utils-ngrFHoWO.js","assets/Dashboard-BWs2N-uP.js","assets/attendanceService-T2F9u1Fy.js","assets/leaveService-CDyZTUNE.js","assets/employeeService-Dp0qongn.js","assets/camera-DOUdOm2H.js","assets/locationTrackingService-B-AXdlBs.js","assets/Employees-CIRCqpjG.js","assets/Attendance-CpBCdUSM.js","assets/shiftService-CSFSagfF.js","assets/AttendanceCalendar-5Lmcvyw-.js","assets/AttendanceReports-C4sEIX5A.js","assets/LeaveRequests-BL9xmv0c.js","assets/MyAttendance-Cd53wtJ3.js","assets/MyLeave-DC5IkT0T.js","assets/Profile-B8GnsL-E.js","assets/ShiftManagement-D53_PCVu.js","assets/PayrollManagement-dTHcnXMg.js","assets/payrollService-Ban35wqE.js","assets/PaymentReports-JTPMOWhP.js","assets/DepartmentManagement-BZnHskYW.js","assets/RoleManagement-DmwGLIOG.js","assets/SystemSettings-CuEAE5XW.js"])))=>i.map(i=>d[i]);
import{r as V,a as F,g as B}from"./vendor-C8w-UNLI.js";import{r as a,u as $,L as h,b as w,c as l,N as E,a as J,B as Q}from"./router-BXhMSvr3.js";import{u as W,a as K,b as D,Q as G,c as H}from"./query-DSXC375t.js";import{z as f,F as Y}from"./ui-I5zzr6O5.js";import{a as X}from"./utils-ngrFHoWO.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))j(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&j(c)}).observe(document,{childList:!0,subtree:!0});function p(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function j(n){if(n.ep)return;n.ep=!0;const i=p(n);fetch(n.href,i)}})();var b={exports:{}},S={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T;function Z(){if(T)return S;T=1;var t=V(),r=Symbol.for("react.element"),p=Symbol.for("react.fragment"),j=Object.prototype.hasOwnProperty,n=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(o,d,m){var u,y={},x=null,s=null;m!==void 0&&(x=""+m),d.key!==void 0&&(x=""+d.key),d.ref!==void 0&&(s=d.ref);for(u in d)j.call(d,u)&&!i.hasOwnProperty(u)&&(y[u]=d[u]);if(o&&o.defaultProps)for(u in d=o.defaultProps,d)y[u]===void 0&&(y[u]=d[u]);return{$$typeof:r,type:o,key:x,ref:s,props:y,_owner:n.current}}return S.Fragment=p,S.jsx=c,S.jsxs=c,S}var U;function ee(){return U||(U=1,b.exports=Z()),b.exports}var e=ee(),L={},C;function te(){if(C)return L;C=1;var t=F();return L.createRoot=t.createRoot,L.hydrateRoot=t.hydrateRoot,L}var re=te();const se=B(re),ne="modulepreload",oe=function(t){return"/"+t},z={},g=function(r,p,j){let n=Promise.resolve();if(p&&p.length>0){let c=function(m){return Promise.all(m.map(u=>Promise.resolve(u).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),d=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=c(p.map(m=>{if(m=oe(m),m in z)return;z[m]=!0;const u=m.endsWith(".css"),y=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${y}`))return;const x=document.createElement("link");if(x.rel=u?"stylesheet":ne,u||(x.as="script"),x.crossOrigin="",x.href=m,d&&x.setAttribute("nonce",d),document.head.appendChild(x),u)return new Promise((s,v)=>{x.addEventListener("load",s),x.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${m}`)))})}))}function i(c){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=c,window.dispatchEvent(o),!o.defaultPrevented)throw c}return n.then(c=>{for(const o of c||[])o.status==="rejected"&&i(o.reason);return r().catch(i)})},A="http://localhost:5000/api",N=X.create({baseURL:A,timeout:1e4,headers:{"Content-Type":"application/json"}});N.interceptors.request.use(t=>{const r=localStorage.getItem("token");return r&&(t.headers.Authorization=`Bearer ${r}`),t},t=>Promise.reject(t));N.interceptors.response.use(t=>t,t=>{var p,j,n,i,c,o,d,m,u,y;if(((p=t.response)==null?void 0:p.status)===401)return localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login",Promise.reject(t);if(t.code==="ECONNABORTED"||t.message.includes("timeout"))return console.error("Request timeout - backend is not responding"),f.error("Cannot connect to server. Please ensure the backend is running at "+A.replace("/api","")),Promise.reject(t);if(t.code==="NETWORK_ERROR"||t.message==="Network Error"||t.code==="ERR_NETWORK")return console.error("Network error - backend may be unavailable at:",A),f.error("Cannot connect to server. Please check if the backend is running."),Promise.reject(t);if(((j=t.response)==null?void 0:j.status)===429)return console.warn("Rate limit exceeded - backend may be temporarily unavailable"),f.error("Server is busy - please try again in a few minutes"),Promise.reject(t);if(((n=t.response)==null?void 0:n.status)>=500)return console.error("Server error:",(i=t.response)==null?void 0:i.data),f.error("Server error - please try again later"),Promise.reject(t);if(((c=t.response)==null?void 0:c.status)>=400&&((o=t.response)==null?void 0:o.status)<500){const x=((m=(d=t.response)==null?void 0:d.data)==null?void 0:m.error)||"Request failed";return f.error(x),Promise.reject(t)}const r=((y=(u=t.response)==null?void 0:u.data)==null?void 0:y.error)||t.message||"An error occurred";return f.error(r),Promise.reject(t)});const _={async login(t){const r=await N.post("/auth/login",t);return{user:r.data.data.user,token:r.data.data.token}},async register(t){const r=await N.post("/auth/register",t);return{user:r.data.data.user,token:r.data.data.token}},async getCurrentUser(){return(await N.get("/auth/me")).data.data.user},logout(){localStorage.removeItem("token"),localStorage.removeItem("user")},isAuthenticated(){try{const t=localStorage.getItem("token");return!(!t||t==="undefined"||t==="null"||t==="")}catch(t){return console.error("Error checking authentication:",t),!1}},getStoredUser(){try{const t=localStorage.getItem("user");return!t||t==="undefined"||t==="null"||t===""?null:t==="undefined"||t==="null"?(localStorage.removeItem("user"),localStorage.removeItem("token"),null):JSON.parse(t)}catch(t){return console.error("Error parsing stored user:",t),localStorage.removeItem("user"),localStorage.removeItem("token"),null}},storeUser(t,r){localStorage.setItem("user",JSON.stringify(t)),localStorage.setItem("token",r)}},M=()=>{const[t,r]=a.useState(null),[p,j]=a.useState(!0),n=W(),i=$();a.useEffect(()=>{try{const s=_.getStoredUser();s&&_.isAuthenticated()&&r(s)}catch(s){console.error("Error initializing auth:",s),_.logout()}finally{j(!1)}},[]);const{data:c,isLoading:o}=K("currentUser",_.getCurrentUser,{enabled:!!t&&_.isAuthenticated(),retry:!1,onError:()=>{_.logout(),r(null)}});a.useEffect(()=>{c&&(r(c),_.storeUser(c,localStorage.getItem("token")))},[c]);const d=D(_.login,{onSuccess:s=>{_.storeUser(s.user,s.token),r(s.user),n.invalidateQueries("currentUser"),f.success("Login successful!"),i("/dashboard")},onError:s=>{var v,R,O,I,k;console.error("Login error:",s),((v=s.response)==null?void 0:v.status)===429?f.error("Server is busy - please try again in a few minutes"):((R=s.response)==null?void 0:R.status)===401?f.error("Invalid email or password"):((O=s.response)==null?void 0:O.status)===0||s.code==="NETWORK_ERROR"?f.error("Cannot connect to server - please check your internet connection"):f.error(((k=(I=s.response)==null?void 0:I.data)==null?void 0:k.error)||"Login failed")}}),m=D(_.register,{onSuccess:s=>{_.storeUser(s.user,s.token),r(s.user),n.invalidateQueries("currentUser"),f.success("Registration successful!"),i("/dashboard")},onError:s=>{var v,R;f.error(((R=(v=s.response)==null?void 0:v.data)==null?void 0:R.error)||"Registration failed")}});return{user:t,isLoading:p||o,login:s=>d.mutateAsync(s),register:s=>m.mutateAsync(s),logout:()=>{_.logout(),r(null),n.clear(),f.success("Logged out successfully")},isLoggingIn:d.isLoading,isRegistering:m.isLoading}},ae=({children:t})=>{const{user:r,logout:p}=M();return console.log("Layout component rendering...",{user:r}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow",children:e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Employee Attendance System"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Welcome, ",r==null?void 0:r.firstName," ",r==null?void 0:r.lastName]}),e.jsx("button",{onClick:p,className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700",children:"Logout"})]})]})})}),e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"px-4 py-2",children:e.jsxs("nav",{className:"flex space-x-4",children:[e.jsx(h,{to:"/",className:"text-blue-600 font-medium",children:"Dashboard"}),(r==null?void 0:r.role)==="SUPER_ADMIN"||(r==null?void 0:r.role)==="HR_MANAGER"?e.jsxs(e.Fragment,{children:[e.jsx(h,{to:"/employees",className:"text-gray-600 hover:text-gray-900",children:"Employees"}),e.jsx(h,{to:"/attendance",className:"text-gray-600 hover:text-gray-900",children:"Attendance"}),e.jsx(h,{to:"/attendance-calendar",className:"text-gray-600 hover:text-gray-900",children:"Calendar"}),e.jsx(h,{to:"/attendance-reports",className:"text-gray-600 hover:text-gray-900",children:"Reports"}),e.jsx(h,{to:"/leave",className:"text-gray-600 hover:text-gray-900",children:"Leave"}),e.jsx(h,{to:"/shifts",className:"text-gray-600 hover:text-gray-900",children:"Shifts"}),e.jsx(h,{to:"/payroll",className:"text-gray-600 hover:text-gray-900",children:"Payroll"}),e.jsx(h,{to:"/payment-reports",className:"text-gray-600 hover:text-gray-900",children:"Payment Reports"}),e.jsx(h,{to:"/departments",className:"text-gray-600 hover:text-gray-900",children:"Departments"}),e.jsx(h,{to:"/roles",className:"text-gray-600 hover:text-gray-900",children:"Roles"}),(r==null?void 0:r.role)==="SUPER_ADMIN"&&e.jsx(e.Fragment,{children:e.jsx(h,{to:"/settings",className:"text-gray-600 hover:text-gray-900",children:"Settings"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{to:"/my-attendance",className:"text-gray-600 hover:text-gray-900",children:"My Attendance"}),e.jsx(h,{to:"/my-leave",className:"text-gray-600 hover:text-gray-900",children:"My Leave"}),e.jsx(h,{to:"/profile",className:"text-gray-600 hover:text-gray-900",children:"Profile"})]})]})})}),e.jsx("main",{className:"p-6",children:t})]})},P=a.memo(({size:t="md",className:r=""})=>{const p={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"};return e.jsx("div",{className:`flex items-center justify-center ${r}`,children:e.jsx("div",{className:`animate-spin rounded-full border-2 border-primary-200 border-t-primary-600 ${p[t]}`})})});P.displayName="LoadingSpinner";const ie=a.lazy(()=>g(()=>import("./Login-Xq8SfIHd.js"),__vite__mapDeps([0,1,2,3,4,5]))),q=a.lazy(()=>g(()=>import("./Dashboard-BWs2N-uP.js"),__vite__mapDeps([6,1,2,4,7,8,9,3,10,11,5]))),le=a.lazy(()=>g(()=>import("./Employees-CIRCqpjG.js"),__vite__mapDeps([12,1,2,4,9,3,5]))),ce=a.lazy(()=>g(()=>import("./Attendance-CpBCdUSM.js"),__vite__mapDeps([13,1,2,4,7,9,14,11,3,10,5]))),ue=a.lazy(()=>g(()=>import("./AttendanceCalendar-5Lmcvyw-.js"),__vite__mapDeps([15,1,2,4,7,9,3,10,5]))),de=a.lazy(()=>g(()=>import("./AttendanceReports-C4sEIX5A.js"),__vite__mapDeps([16,1,2,4,7,9,3,5]))),me=a.lazy(()=>g(()=>import("./LeaveRequests-BL9xmv0c.js"),__vite__mapDeps([17,1,2,4,8,9,3,5]))),pe=a.lazy(()=>g(()=>import("./MyAttendance-Cd53wtJ3.js"),__vite__mapDeps([18,1,2,4,7,10,3,5]))),ge=a.lazy(()=>g(()=>import("./MyLeave-DC5IkT0T.js"),__vite__mapDeps([19,1,2,4,8,3,5]))),xe=a.lazy(()=>g(()=>import("./Profile-B8GnsL-E.js"),__vite__mapDeps([20,3,1,2,4,5]))),he=a.lazy(()=>g(()=>import("./ShiftManagement-D53_PCVu.js"),__vite__mapDeps([21,1,2,4,14,9,3,5]))),ye=a.lazy(()=>g(()=>import("./PayrollManagement-dTHcnXMg.js"),__vite__mapDeps([22,1,2,4,23,9,7,3,5]))),fe=a.lazy(()=>g(()=>import("./PaymentReports-JTPMOWhP.js"),__vite__mapDeps([24,1,2,4,23,9,3,5]))),_e=a.lazy(()=>g(()=>import("./DepartmentManagement-BZnHskYW.js"),__vite__mapDeps([25,1,2,4,9,3,5]))),je=a.lazy(()=>g(()=>import("./RoleManagement-DmwGLIOG.js"),__vite__mapDeps([26,1,2,4,9,3,5]))),ve=a.lazy(()=>g(()=>import("./SystemSettings-CuEAE5XW.js"),__vite__mapDeps([27,1,2,4,3,5])));function Re(){const{user:t,isLoading:r}=M();if(r)return e.jsx(P,{});if(!t)return e.jsx(a.Suspense,{fallback:e.jsx(P,{}),children:e.jsxs(w,{children:[e.jsx(l,{path:"/login",element:e.jsx(ie,{})}),e.jsx(l,{path:"*",element:e.jsx(E,{to:"/login",replace:!0})})]})});const p=(t==null?void 0:t.role)==="SUPER_ADMIN"||(t==null?void 0:t.role)==="HR_MANAGER";return e.jsx(ae,{children:e.jsx(a.Suspense,{fallback:e.jsx(P,{}),children:e.jsxs(w,{children:[e.jsx(l,{path:"/",element:e.jsx(q,{})}),e.jsx(l,{path:"/dashboard",element:e.jsx(q,{})}),e.jsx(l,{path:"/profile",element:e.jsx(xe,{})}),p?e.jsxs(e.Fragment,{children:[e.jsx(l,{path:"/employees",element:e.jsx(le,{})}),e.jsx(l,{path:"/attendance",element:e.jsx(ce,{})}),e.jsx(l,{path:"/attendance-calendar",element:e.jsx(ue,{})}),e.jsx(l,{path:"/attendance-reports",element:e.jsx(de,{})}),e.jsx(l,{path:"/leave",element:e.jsx(me,{})}),e.jsx(l,{path:"/shifts",element:e.jsx(he,{})}),e.jsx(l,{path:"/payroll",element:e.jsx(ye,{})}),e.jsx(l,{path:"/payment-reports",element:e.jsx(fe,{})}),e.jsx(l,{path:"/departments",element:e.jsx(_e,{})}),e.jsx(l,{path:"/roles",element:e.jsx(je,{})}),e.jsx(l,{path:"/settings",element:e.jsx(ve,{})})]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{path:"/my-attendance",element:e.jsx(pe,{})}),e.jsx(l,{path:"/my-leave",element:e.jsx(ge,{})}),e.jsx(l,{path:"/attendance",element:e.jsx(E,{to:"/my-attendance",replace:!0})}),e.jsx(l,{path:"/leave",element:e.jsx(E,{to:"/my-leave",replace:!0})})]}),e.jsx(l,{path:"/login",element:e.jsx(E,{to:"/",replace:!0})}),e.jsx(l,{path:"*",element:e.jsx(E,{to:"/",replace:!0})})]})})})}const Ee=new G({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});se.createRoot(document.getElementById("root")).render(e.jsx(J.StrictMode,{children:e.jsx(H,{client:Ee,children:e.jsxs(Q,{children:[e.jsx(Re,{}),e.jsx(Y,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{duration:5e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})})}));export{_ as a,N as b,e as j,M as u};
//# sourceMappingURL=index-D5uMa6cf.js.map
