import{j as e}from"./index-CJqNwkMI.js";import{r as u}from"./router-BXhMSvr3.js";import{u as H,a as Y,b as y}from"./query-DSXC375t.js";import{l as j}from"./leaveService-FQ1hqWgu.js";import{e as W}from"./employeeService-CK3_iFt-.js";import{P as Q,C as Z,e as J,f as z,a as K,S as ee,c as se,E as te,T as ae,z as o}from"./ui-CenJk824.js";import"./vendor-C8w-UNLI.js";import"./utils-ngrFHoWO.js";const ue=()=>{var b,f,E,w,L,q,R,C,S,A,T;const[N,d]=u.useState(!1),[p,l]=u.useState(""),[n,x]=u.useState(""),[m,t]=u.useState(""),c=H(),{data:a,isLoading:h,error:B}=Y(["leaveRequests",p,n,m],()=>j.getLeaveRequests({status:n,leaveType:m})),{data:v}=Y("employees",()=>W.getEmployees()),U=y(({id:s,status:r,comments:i})=>j.updateLeaveRequestStatus(s,{status:r,comments:i}),{onSuccess:()=>{c.invalidateQueries("leaveRequests"),o.success("Leave request updated successfully")},onError:s=>{var r,i;o.error(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.error)||"Failed to update leave request")}}),X=y(j.deleteLeaveRequest,{onSuccess:()=>{c.invalidateQueries("leaveRequests"),o.success("Leave request deleted successfully")},onError:s=>{var r,i;o.error(((i=(r=s.response)==null?void 0:r.data)==null?void 0:i.error)||"Failed to delete leave request")}}),g=(s,r,i)=>{U.mutate({id:s,status:r,comments:i})},$=s=>{window.confirm("Are you sure you want to delete this leave request?")&&X.mutate(s)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Leave Requests"}),e.jsx("p",{className:"text-gray-600",children:"Manage employee leave requests and approvals"})]}),e.jsxs("button",{onClick:()=>d(!0),className:"btn btn-primary btn-md",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Request Leave"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(Z,{className:"h-5 w-5 text-yellow-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:((f=(b=a==null?void 0:a.data)==null?void 0:b.leaveRequests)==null?void 0:f.filter(s=>s.status==="PENDING").length)||0})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(J,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Approved"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:((w=(E=a==null?void 0:a.data)==null?void 0:E.leaveRequests)==null?void 0:w.filter(s=>s.status==="APPROVED").length)||0})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(z,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rejected"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:((q=(L=a==null?void 0:a.data)==null?void 0:L.leaveRequests)==null?void 0:q.filter(s=>s.status==="REJECTED").length)||0})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(K,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:((C=(R=a==null?void 0:a.data)==null?void 0:R.leaveRequests)==null?void 0:C.length)||0})]})]})})]}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search leave requests...",className:"input pl-10",value:p,onChange:s=>l(s.target.value)})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{className:"input",value:n,onChange:s=>x(s.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"REJECTED",children:"Rejected"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]}),e.jsxs("select",{className:"input",value:m,onChange:s=>t(s.target.value),children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"SICK_LEAVE",children:"Sick Leave"}),e.jsx("option",{value:"VACATION",children:"Vacation"}),e.jsx("option",{value:"PERSONAL_LEAVE",children:"Personal Leave"}),e.jsx("option",{value:"EMERGENCY_LEAVE",children:"Emergency Leave"}),e.jsx("option",{value:"MATERNITY_LEAVE",children:"Maternity Leave"}),e.jsx("option",{value:"PATERNITY_LEAVE",children:"Paternity Leave"})]}),e.jsxs("button",{className:"btn btn-outline btn-md",onClick:()=>{l(""),x(""),t("")},children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Clear"]})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Leave Requests"})}),e.jsx("div",{className:"p-6",children:h?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Loading leave requests..."})]}):B?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-red-600",children:"Error loading leave requests"})}):(A=(S=a==null?void 0:a.data)==null?void 0:S.leaveRequests)!=null&&A.length?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Leave Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Start Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"End Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Days"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.data.leaveRequests.map(s=>{var r,i,P,D,k,V,I,M,_,F,O,G;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsxs("span",{className:"text-blue-600 font-medium",children:[(P=(i=(r=s.employee)==null?void 0:r.user)==null?void 0:i.firstName)==null?void 0:P.charAt(0),(V=(k=(D=s.employee)==null?void 0:D.user)==null?void 0:k.lastName)==null?void 0:V.charAt(0)]})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[(M=(I=s.employee)==null?void 0:I.user)==null?void 0:M.firstName," ",(F=(_=s.employee)==null?void 0:_.user)==null?void 0:F.lastName]}),e.jsx("div",{className:"text-sm text-gray-500",children:(G=(O=s.employee)==null?void 0:O.user)==null?void 0:G.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.leaveType.replace("_"," ")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(s.startDate).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(s.endDate).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.days}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.status==="APPROVED"?"bg-green-100 text-green-800":s.status==="REJECTED"?"bg-red-100 text-red-800":s.status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"text-blue-600 hover:text-blue-900",children:e.jsx(te,{className:"h-4 w-4"})}),s.status==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>g(s.id,"APPROVED"),className:"text-green-600 hover:text-green-900",title:"Approve",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>g(s.id,"REJECTED"),className:"text-red-600 hover:text-red-900",title:"Reject",children:e.jsx(z,{className:"h-4 w-4"})})]}),e.jsx("button",{onClick:()=>$(s.id),className:"text-red-600 hover:text-red-900",children:e.jsx(ae,{className:"h-4 w-4"})})]})})]},s.id)})})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(K,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No leave requests found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Start by creating a new leave request"}),e.jsxs("button",{onClick:()=>d(!0),className:"btn btn-primary btn-md",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Request Leave"]})]})})]}),N&&e.jsx(le,{onClose:()=>d(!1),onSuccess:()=>{d(!1),c.invalidateQueries("leaveRequests")},employees:((T=v==null?void 0:v.data)==null?void 0:T.employees)||[]})]})},le=({onClose:N,onSuccess:d,employees:p})=>{const[l,n]=u.useState({employeeId:"",leaveType:"SICK_LEAVE",startDate:"",endDate:"",reason:""}),x=y(j.createLeaveRequest,{onSuccess:()=>{o.success("Leave request submitted successfully!"),d()},onError:t=>{var c,a;o.error(((a=(c=t.response)==null?void 0:c.data)==null?void 0:a.error)||"Failed to submit leave request")}}),m=t=>{t.preventDefault(),x.mutate(l)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Request Leave"}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employee *"}),e.jsxs("select",{className:"input",value:l.employeeId,onChange:t=>n({...l,employeeId:t.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select Employee"}),p.map(t=>{var c,a,h;return e.jsxs("option",{value:t.id,children:[(c=t.user)==null?void 0:c.firstName," ",(a=t.user)==null?void 0:a.lastName," (",(h=t.user)==null?void 0:h.email,")"]},t.id)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Leave Type *"}),e.jsxs("select",{className:"input",value:l.leaveType,onChange:t=>n({...l,leaveType:t.target.value}),required:!0,children:[e.jsx("option",{value:"SICK_LEAVE",children:"Sick Leave"}),e.jsx("option",{value:"VACATION",children:"Vacation"}),e.jsx("option",{value:"PERSONAL_LEAVE",children:"Personal Leave"}),e.jsx("option",{value:"EMERGENCY_LEAVE",children:"Emergency Leave"}),e.jsx("option",{value:"MATERNITY_LEAVE",children:"Maternity Leave"}),e.jsx("option",{value:"PATERNITY_LEAVE",children:"Paternity Leave"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Start Date *"}),e.jsx("input",{type:"date",className:"input",value:l.startDate,onChange:t=>n({...l,startDate:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"End Date *"}),e.jsx("input",{type:"date",className:"input",value:l.endDate,onChange:t=>n({...l,endDate:t.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reason *"}),e.jsx("textarea",{className:"input",rows:3,value:l.reason,onChange:t=>n({...l,reason:t.target.value}),placeholder:"Please provide a reason for your leave request...",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:N,className:"btn btn-outline btn-md",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:x.isLoading,className:"btn btn-primary btn-md",children:x.isLoading?"Submitting...":"Submit Request"})]})]})]})})};export{ue as default};
//# sourceMappingURL=LeaveRequests-D8Edusqy.js.map
