import{u as A,j as e}from"./index-j-xEUIA1.js";import{r as o}from"./router-BXhMSvr3.js";import{u as k,a as M,b as T}from"./query-DSXC375t.js";import{l as h}from"./leaveService-Bbv6vZsM.js";import{P as R,C as _,c as F,g as O,a as S,S as G,e as Y,z as u}from"./ui-BANi3Jhe.js";import"./vendor-C8w-UNLI.js";import"./utils-ngrFHoWO.js";const U=()=>{var j,v,N,y,g,b,f,E,w,L;const{user:c}=A(),[p,r]=o.useState(!1),[l,n]=o.useState(""),[i,m]=o.useState(""),[a,d]=o.useState(""),x=k(),{data:t,isLoading:P,error:D}=M(["my-leave-requests",l,i,a],()=>h.getLeaveRequests({employeeId:c==null?void 0:c.employeeId,status:i,leaveType:a})),I=T(h.cancelLeaveRequest,{onSuccess:()=>{x.invalidateQueries("my-leave-requests"),u.success("Leave request cancelled successfully")},onError:s=>{var q,C;u.error(((C=(q=s.response)==null?void 0:q.data)==null?void 0:C.error)||"Failed to cancel leave request")}}),V=s=>{window.confirm("Are you sure you want to cancel this leave request?")&&I.mutate(s)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Leave Requests"}),e.jsx("p",{className:"text-gray-600",children:"Manage your leave requests and history"})]}),e.jsxs("button",{onClick:()=>r(!0),className:"btn btn-primary btn-md",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Request Leave"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(_,{className:"h-5 w-5 text-yellow-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:((v=(j=t==null?void 0:t.data)==null?void 0:j.leaveRequests)==null?void 0:v.filter(s=>s.status==="PENDING").length)||0})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(F,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Approved"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:((y=(N=t==null?void 0:t.data)==null?void 0:N.leaveRequests)==null?void 0:y.filter(s=>s.status==="APPROVED").length)||0})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(O,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rejected"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:((b=(g=t==null?void 0:t.data)==null?void 0:g.leaveRequests)==null?void 0:b.filter(s=>s.status==="REJECTED").length)||0})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(S,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:((E=(f=t==null?void 0:t.data)==null?void 0:f.leaveRequests)==null?void 0:E.length)||0})]})]})})]}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search leave requests...",className:"input pl-10",value:l,onChange:s=>n(s.target.value)})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{className:"input",value:i,onChange:s=>m(s.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"REJECTED",children:"Rejected"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]}),e.jsxs("select",{className:"input",value:a,onChange:s=>d(s.target.value),children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"SICK_LEAVE",children:"Sick Leave"}),e.jsx("option",{value:"VACATION",children:"Vacation"}),e.jsx("option",{value:"PERSONAL_LEAVE",children:"Personal Leave"}),e.jsx("option",{value:"EMERGENCY_LEAVE",children:"Emergency Leave"}),e.jsx("option",{value:"MATERNITY_LEAVE",children:"Maternity Leave"}),e.jsx("option",{value:"PATERNITY_LEAVE",children:"Paternity Leave"})]}),e.jsxs("button",{className:"btn btn-outline btn-md",onClick:()=>{n(""),m(""),d("")},children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Clear"]})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"My Leave Requests"})}),e.jsx("div",{className:"p-6",children:P?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Loading leave requests..."})]}):D?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-red-600",children:"Error loading leave requests"})}):(L=(w=t==null?void 0:t.data)==null?void 0:w.leaveRequests)!=null&&L.length?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Leave Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Start Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"End Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Days"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.data.leaveRequests.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.leaveType.replace("_"," ")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(s.startDate).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(s.endDate).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.days}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.status==="APPROVED"?"bg-green-100 text-green-800":s.status==="REJECTED"?"bg-red-100 text-red-800":s.status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.status==="PENDING"&&e.jsx("button",{onClick:()=>V(s.id),className:"text-red-600 hover:text-red-900",title:"Cancel Leave Request",children:"Cancel"})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(S,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No leave requests found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Start by creating a new leave request"}),e.jsxs("button",{onClick:()=>r(!0),className:"btn btn-primary btn-md",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Request Leave"]})]})})]}),p&&e.jsx(Q,{onClose:()=>r(!1),onSuccess:()=>{r(!1),x.invalidateQueries("my-leave-requests")}})]})},Q=({onClose:c,onSuccess:p})=>{const{user:r}=A(),[l,n]=o.useState({leaveType:"SICK_LEAVE",startDate:"",endDate:"",reason:""}),i=T(h.createLeaveRequest,{onSuccess:()=>{u.success("Leave request submitted successfully!"),p()},onError:a=>{var d,x;u.error(((x=(d=a.response)==null?void 0:d.data)==null?void 0:x.error)||"Failed to submit leave request")}}),m=a=>{a.preventDefault(),r!=null&&r.employeeId&&i.mutate({employeeId:r.employeeId,...l})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Request Leave"}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Leave Type *"}),e.jsxs("select",{className:"input",value:l.leaveType,onChange:a=>n({...l,leaveType:a.target.value}),required:!0,children:[e.jsx("option",{value:"SICK_LEAVE",children:"Sick Leave"}),e.jsx("option",{value:"VACATION",children:"Vacation"}),e.jsx("option",{value:"PERSONAL_LEAVE",children:"Personal Leave"}),e.jsx("option",{value:"EMERGENCY_LEAVE",children:"Emergency Leave"}),e.jsx("option",{value:"MATERNITY_LEAVE",children:"Maternity Leave"}),e.jsx("option",{value:"PATERNITY_LEAVE",children:"Paternity Leave"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Start Date *"}),e.jsx("input",{type:"date",className:"input",value:l.startDate,onChange:a=>n({...l,startDate:a.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"End Date *"}),e.jsx("input",{type:"date",className:"input",value:l.endDate,onChange:a=>n({...l,endDate:a.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reason *"}),e.jsx("textarea",{className:"input",rows:3,value:l.reason,onChange:a=>n({...l,reason:a.target.value}),placeholder:"Please provide a reason for your leave request...",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:c,className:"btn btn-outline btn-md",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:i.isLoading,className:"btn btn-primary btn-md",children:i.isLoading?"Submitting...":"Submit Request"})]})]})]})})};export{U as default};
//# sourceMappingURL=MyLeave-B2mDJVJE.js.map
