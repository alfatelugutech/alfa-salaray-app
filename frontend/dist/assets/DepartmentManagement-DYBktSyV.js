import{b as h,j as e}from"./index-DMnC-NiN.js";import{r as j}from"./router-BXhMSvr3.js";import{u as A,a as w,b as N}from"./query-DSXC375t.js";import{e as E}from"./employeeService-FJUdo1d5.js";import{P as I,x as q,y as L,U,f as F,T as Q,z as u}from"./ui-BANi3Jhe.js";import"./vendor-C8w-UNLI.js";import"./utils-ngrFHoWO.js";const g={async getDepartments(){return(await h.get("/departments")).data.data},async getDepartment(t){return(await h.get(`/departments/${t}`)).data.data},async createDepartment(t){return(await h.post("/departments",t)).data.data},async updateDepartment(t,c){return(await h.put(`/departments/${t}`,c)).data.data},async deleteDepartment(t){await h.delete(`/departments/${t}`)}},G=()=>{var y,f;const[t,c]=j.useState(!1),[m,o]=j.useState(null),[l,i]=j.useState(""),d=A(),{data:a,isLoading:r}=w("departments",g.getDepartments),{data:p}=w("employees",()=>E.getEmployees({page:1,limit:1e3})),b=N(s=>g.createDepartment(s),{onSuccess:()=>{d.invalidateQueries({queryKey:["departments"]}),c(!1),u.success("Department created successfully")},onError:s=>{var n,x;u.error(((x=(n=s.response)==null?void 0:n.data)==null?void 0:x.error)||"Failed to create department")}}),v=N(({id:s,data:n})=>g.updateDepartment(s,n),{onSuccess:()=>{d.invalidateQueries({queryKey:["departments"]}),o(null),u.success("Department updated successfully")},onError:s=>{var n,x;u.error(((x=(n=s.response)==null?void 0:n.data)==null?void 0:x.error)||"Failed to update department")}}),D=N(s=>g.deleteDepartment(s),{onSuccess:()=>{d.invalidateQueries({queryKey:["departments"]}),u.success("Department deleted successfully")},onError:s=>{var n,x;u.error(((x=(n=s.response)==null?void 0:n.data)==null?void 0:x.error)||"Failed to delete department")}}),C=s=>{b.mutate(s)},S=s=>{m&&v.mutate({id:m.id,data:s})},k=s=>{window.confirm("Are you sure you want to delete this department?")&&D.mutate(s)},M=(a||[]).filter(s=>{var n;return s.name.toLowerCase().includes(l.toLowerCase())||((n=s.description)==null?void 0:n.toLowerCase().includes(l.toLowerCase()))});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Department Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage departments and assign managers"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"btn btn-primary mt-4 sm:mt-0",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Create Department"]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search departments...",value:l,onChange:s=>i(s.target.value),className:"input"})})})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border",children:r?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Loading departments..."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Manager"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employees"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map(s=>{var n;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg mr-3",children:e.jsx(q,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),s.description&&e.jsx("div",{className:"text-sm text-gray-500",children:s.description})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.manager?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-1 bg-green-100 rounded-full mr-2",children:e.jsx(L,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.manager.firstName," ",s.manager.lastName]}),e.jsx("div",{className:"text-sm text-gray-500",children:s.manager.email})]})]}):e.jsx("span",{className:"text-gray-400 text-sm",children:"No manager assigned"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[((n=s._count)==null?void 0:n.employees)||0," employees"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>o(s),className:"text-blue-600 hover:text-blue-900",children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>k(s.id),className:"text-red-600 hover:text-red-900",children:e.jsx(Q,{className:"w-4 h-4"})})]})})]},s.id)})})]})})}),t&&e.jsx(z,{employees:((y=p==null?void 0:p.data)==null?void 0:y.employees)||[],onClose:()=>c(!1),onSubmit:C,isLoading:b.isLoading}),m&&e.jsx(T,{department:m,employees:((f=p==null?void 0:p.data)==null?void 0:f.employees)||[],onClose:()=>o(null),onSubmit:S,isLoading:v.isLoading})]})},z=({employees:t,onClose:c,onSubmit:m,isLoading:o})=>{const[l,i]=j.useState({name:"",description:"",managerId:""}),d=a=>{a.preventDefault(),m(l)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create Department"}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Department Name"}),e.jsx("input",{type:"text",value:l.name,onChange:a=>i({...l,name:a.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("textarea",{value:l.description,onChange:a=>i({...l,description:a.target.value}),className:"input",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Manager (Optional)"}),e.jsxs("select",{value:l.managerId,onChange:a=>i({...l,managerId:a.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Manager"}),t.map(a=>e.jsxs("option",{value:a.user.id,children:[a.user.firstName," ",a.user.lastName]},a.id))]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:c,className:"btn btn-outline",disabled:o,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"Creating...":"Create Department"})]})]})]})})},T=({department:t,employees:c,onClose:m,onSubmit:o,isLoading:l})=>{const[i,d]=j.useState({name:t.name,description:t.description||"",managerId:t.managerId||"",isActive:t.isActive}),a=r=>{r.preventDefault(),o(i)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Department"}),e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Department Name"}),e.jsx("input",{type:"text",value:i.name,onChange:r=>d({...i,name:r.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("textarea",{value:i.description,onChange:r=>d({...i,description:r.target.value}),className:"input",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Manager"}),e.jsxs("select",{value:i.managerId,onChange:r=>d({...i,managerId:r.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select Manager"}),c.map(r=>e.jsxs("option",{value:r.user.id,children:[r.user.firstName," ",r.user.lastName]},r.id))]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:i.isActive,onChange:r=>d({...i,isActive:r.target.checked}),className:"mr-2"}),"Active"]})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:m,className:"btn btn-outline",disabled:l,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:l,children:l?"Updating...":"Update Department"})]})]})]})})};export{G as default};
//# sourceMappingURL=DepartmentManagement-DYBktSyV.js.map
