const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-CjztsF1s.js","assets/router-BXhMSvr3.js","assets/vendor-C8w-UNLI.js","assets/ui-BANi3Jhe.js","assets/query-DSXC375t.js","assets/utils-ngrFHoWO.js","assets/Dashboard-CEkf3Kzk.js","assets/attendanceService-DsnHSZe0.js","assets/leaveService-DxykOXys.js","assets/employeeService-FJUdo1d5.js","assets/camera-uGge9r08.js","assets/locationTrackingService-CW--L6Zz.js","assets/Employees-CNTSTNKD.js","assets/Attendance-gmVi7Xut.js","assets/shiftService-DzsMqJ-g.js","assets/AttendanceCalendar-BxKJwSdO.js","assets/AttendanceReports-lNOdwELt.js","assets/LeaveRequests-C3Gzqzju.js","assets/MyAttendance-C-h9j9fW.js","assets/MyLeave-DFniynnj.js","assets/Profile-CjQuK13W.js","assets/ShiftManagement-o7mLdxW8.js","assets/PayrollManagement-Q1itn8_j.js","assets/payrollService-DCwl2fOX.js","assets/PaymentReports-gtaeXK9S.js","assets/DepartmentManagement-DYBktSyV.js","assets/RoleManagement-DdTe5R3R.js","assets/SystemSettings-kNoVhDlq.js"])))=>i.map(i=>d[i]);
import{r as V,a as F,g as $}from"./vendor-C8w-UNLI.js";import{r as i,u as J,L as Q,b as I,c,N as S,a as W,B as H}from"./router-BXhMSvr3.js";import{u as K,a as G,b as w,Q as Y,c as X}from"./query-DSXC375t.js";import{z as h,F as Z}from"./ui-BANi3Jhe.js";import{a as q}from"./utils-ngrFHoWO.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))x(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&x(l)}).observe(document,{childList:!0,subtree:!0});function p(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function x(s){if(s.ep)return;s.ep=!0;const o=p(s);fetch(s.href,o)}})();var O={exports:{}},b={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D;function ee(){if(D)return b;D=1;var e=V(),r=Symbol.for("react.element"),p=Symbol.for("react.fragment"),x=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(a,d,m){var u,y={},f=null,n=null;m!==void 0&&(f=""+m),d.key!==void 0&&(f=""+d.key),d.ref!==void 0&&(n=d.ref);for(u in d)x.call(d,u)&&!o.hasOwnProperty(u)&&(y[u]=d[u]);if(a&&a.defaultProps)for(u in d=a.defaultProps,d)y[u]===void 0&&(y[u]=d[u]);return{$$typeof:r,type:a,key:f,ref:n,props:y,_owner:s.current}}return b.Fragment=p,b.jsx=l,b.jsxs=l,b}var T;function te(){return T||(T=1,O.exports=ee()),O.exports}var t=te(),k={},U;function re(){if(U)return k;U=1;var e=F();return k.createRoot=e.createRoot,k.hydrateRoot=e.hydrateRoot,k}var se=re();const ne=$(se),oe="modulepreload",ae=function(e){return"/"+e},C={},g=function(r,p,x){let s=Promise.resolve();if(p&&p.length>0){let l=function(m){return Promise.all(m.map(u=>Promise.resolve(u).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),d=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=l(p.map(m=>{if(m=ae(m),m in C)return;C[m]=!0;const u=m.endsWith(".css"),y=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${y}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":oe,u||(f.as="script"),f.crossOrigin="",f.href=m,d&&f.setAttribute("nonce",d),document.head.appendChild(f),u)return new Promise((n,v)=>{f.addEventListener("load",n),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${m}`)))})}))}function o(l){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=l,window.dispatchEvent(a),!a.defaultPrevented)throw l}return s.then(l=>{for(const a of l||[])a.status==="rejected"&&o(a.reason);return r().catch(o)})},A="https://alfa-salaray-app.onrender.com/api",L=q.create({baseURL:A,timeout:1e4,headers:{"Content-Type":"application/json"}});console.log("🔗 API Base URL:",A);console.log("🌍 Environment:","production");const Ne=async()=>{try{const e=await q.get(`${A.replace("/api","")}/health`,{timeout:5e3});return console.log("✅ Backend health check passed:",e.data),{isHealthy:!0,data:e.data}}catch(e){return console.error("❌ Backend health check failed:",e.message),{isHealthy:!1,error:e.message}}};L.interceptors.request.use(e=>{const r=localStorage.getItem("token");return r&&(e.headers.Authorization=`Bearer ${r}`),e},e=>Promise.reject(e));L.interceptors.response.use(e=>e,e=>{var p,x,s,o,l,a,d,m,u,y,f,n,v,j,E,R,P;if(console.error("API Error:",{url:(p=e.config)==null?void 0:p.url,method:(x=e.config)==null?void 0:x.method,status:(s=e.response)==null?void 0:s.status,statusText:(o=e.response)==null?void 0:o.statusText,data:(l=e.response)==null?void 0:l.data,message:e.message,code:e.code}),((a=e.response)==null?void 0:a.status)===401)return localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login",Promise.reject(e);if(e.code==="ECONNABORTED"||e.message.includes("timeout"))return console.error("Request timeout - backend is not responding"),console.error("Backend URL:",A),h.error("Server timeout. The backend may be slow or overloaded. Please try again."),Promise.reject(e);if(e.code==="NETWORK_ERROR"||e.message==="Network Error"||e.code==="ERR_NETWORK")return console.error("Network error - backend may be unavailable at:",A),console.error("Full error:",e),h.error("Network error. Please check your internet connection and try again."),Promise.reject(e);if(e.code==="ECONNREFUSED"||e.message.includes("Connection refused"))return console.error("Connection refused - backend is not running"),h.error("Backend server is not running. Please contact support."),Promise.reject(e);if(((d=e.response)==null?void 0:d.status)===502||((m=e.response)==null?void 0:m.status)===503)return console.error("Backend service unavailable:",e.response.status),h.error("Backend service is temporarily unavailable. Please try again later."),Promise.reject(e);if(((u=e.response)==null?void 0:u.status)===429)return console.warn("Rate limit exceeded - backend may be temporarily unavailable"),h.error("Server is busy - please try again in a few minutes"),Promise.reject(e);if(((y=e.response)==null?void 0:y.status)>=500)return console.error("Server error:",(f=e.response)==null?void 0:f.data),h.error("Server error - please try again later"),Promise.reject(e);if(((n=e.response)==null?void 0:n.status)>=400&&((v=e.response)==null?void 0:v.status)<500){const B=((E=(j=e.response)==null?void 0:j.data)==null?void 0:E.error)||"Request failed";return h.error(B),Promise.reject(e)}const r=((P=(R=e.response)==null?void 0:R.data)==null?void 0:P.error)||e.message||"An error occurred";return h.error(r),Promise.reject(e)});const _={async login(e){const r=await L.post("/auth/login",e);return{user:r.data.data.user,token:r.data.data.token}},async register(e){const r=await L.post("/auth/register",e);return{user:r.data.data.user,token:r.data.data.token}},async getCurrentUser(){return(await L.get("/auth/me")).data.data.user},logout(){localStorage.removeItem("token"),localStorage.removeItem("user")},isAuthenticated(){try{const e=localStorage.getItem("token");return!(!e||e==="undefined"||e==="null"||e==="")}catch(e){return console.error("Error checking authentication:",e),!1}},getStoredUser(){try{const e=localStorage.getItem("user");return!e||e==="undefined"||e==="null"||e===""?null:e==="undefined"||e==="null"?(localStorage.removeItem("user"),localStorage.removeItem("token"),null):JSON.parse(e)}catch(e){return console.error("Error parsing stored user:",e),localStorage.removeItem("user"),localStorage.removeItem("token"),null}},storeUser(e,r){localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("token",r)}},M=()=>{const[e,r]=i.useState(null),[p,x]=i.useState(!0),s=K(),o=J();i.useEffect(()=>{try{const n=_.getStoredUser();n&&_.isAuthenticated()&&r(n)}catch(n){console.error("Error initializing auth:",n),_.logout()}finally{x(!1)}},[]);const{data:l,isLoading:a}=G("currentUser",_.getCurrentUser,{enabled:!!e&&_.isAuthenticated(),retry:!1,onError:()=>{_.logout(),r(null)}});i.useEffect(()=>{l&&(r(l),_.storeUser(l,localStorage.getItem("token")))},[l]);const d=w(_.login,{onSuccess:n=>{_.storeUser(n.user,n.token),r(n.user),s.invalidateQueries("currentUser"),h.success("Login successful!"),o("/dashboard")},onError:n=>{var v,j,E,R,P;console.error("Login error:",n),((v=n.response)==null?void 0:v.status)===429?h.error("Server is busy - please try again in a few minutes"):((j=n.response)==null?void 0:j.status)===401?h.error("Invalid email or password"):((E=n.response)==null?void 0:E.status)===0||n.code==="NETWORK_ERROR"?h.error("Cannot connect to server - please check your internet connection"):h.error(((P=(R=n.response)==null?void 0:R.data)==null?void 0:P.error)||"Login failed")}}),m=w(_.register,{onSuccess:n=>{_.storeUser(n.user,n.token),r(n.user),s.invalidateQueries("currentUser"),h.success("Registration successful!"),o("/dashboard")},onError:n=>{var v,j;h.error(((j=(v=n.response)==null?void 0:v.data)==null?void 0:j.error)||"Registration failed")}});return{user:e,isLoading:p||a,login:n=>d.mutateAsync(n),register:n=>m.mutateAsync(n),logout:()=>{_.logout(),r(null),s.clear(),h.success("Logged out successfully")},isLoggingIn:d.isLoading,isRegistering:m.isLoading}},ie=({children:e})=>{const{user:r,logout:p}=M();console.log("Layout component rendering...",{user:r});const x=()=>{if(!r)return[];const s=[{name:"Dashboard",href:"/dashboard",icon:"🏠"},{name:"My Attendance",href:"/my-attendance",icon:"📅"}];return r.role==="SUPER_ADMIN"||r.role==="HR_MANAGER"?[...s,{name:"Employees",href:"/employees",icon:"👥"},{name:"Attendance",href:"/attendance",icon:"📊"},{name:"Calendar",href:"/attendance-calendar",icon:"📅"},{name:"Reports",href:"/attendance-reports",icon:"📈"},{name:"Leave Management",href:"/leave",icon:"🏖️"},{name:"Shifts",href:"/shifts",icon:"⏰"},{name:"Payroll",href:"/payroll",icon:"💰"},{name:"Payment Reports",href:"/payment-reports",icon:"💳"},{name:"Departments",href:"/departments",icon:"🏢"},{name:"Roles",href:"/roles",icon:"👤"},...r.role==="SUPER_ADMIN"?[{name:"Settings",href:"/settings",icon:"⚙️"}]:[]]:[...s,{name:"My Leave",href:"/my-leave",icon:"🏖️"},{name:"Profile",href:"/profile",icon:"👤"}]};return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white shadow",children:t.jsx("div",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Employee Attendance System"}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("span",{className:"text-sm text-gray-600",children:["Welcome, ",r==null?void 0:r.firstName," ",r==null?void 0:r.lastName]}),t.jsx("button",{onClick:p,className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700",children:"Logout"})]})]})})}),t.jsx("div",{className:"bg-white border-b shadow-sm",children:t.jsx("div",{className:"px-4 py-3",children:t.jsx("nav",{className:"flex flex-wrap gap-2",children:x().map((s,o)=>t.jsxs(Q,{to:s.href,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 hover:shadow-sm",children:[t.jsx("span",{className:"text-lg",children:s.icon}),t.jsx("span",{children:s.name})]},o))})})}),t.jsx("main",{className:"p-6",children:e})]})},N=i.memo(({size:e="md",className:r=""})=>{const p={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"};return t.jsx("div",{className:`flex items-center justify-center ${r}`,children:t.jsx("div",{className:`animate-spin rounded-full border-2 border-primary-200 border-t-primary-600 ${p[e]}`})})});N.displayName="LoadingSpinner";const ce=i.lazy(()=>g(()=>import("./Login-CjztsF1s.js"),__vite__mapDeps([0,1,2,3,4,5]))),z=i.lazy(()=>g(()=>import("./Dashboard-CEkf3Kzk.js"),__vite__mapDeps([6,1,2,4,7,8,9,3,10,11,5]))),le=i.lazy(()=>g(()=>import("./Employees-CNTSTNKD.js"),__vite__mapDeps([12,1,2,4,9,3,5]))),ue=i.lazy(()=>g(()=>import("./Attendance-gmVi7Xut.js"),__vite__mapDeps([13,1,2,4,7,9,14,11,3,10,5]))),de=i.lazy(()=>g(()=>import("./AttendanceCalendar-BxKJwSdO.js"),__vite__mapDeps([15,1,2,4,7,9,3,10,5]))),me=i.lazy(()=>g(()=>import("./AttendanceReports-lNOdwELt.js"),__vite__mapDeps([16,1,2,4,7,9,3,5]))),pe=i.lazy(()=>g(()=>import("./LeaveRequests-C3Gzqzju.js"),__vite__mapDeps([17,1,2,4,8,9,3,5]))),fe=i.lazy(()=>g(()=>import("./MyAttendance-C-h9j9fW.js"),__vite__mapDeps([18,1,2,4,7,10,3,5]))),he=i.lazy(()=>g(()=>import("./MyLeave-DFniynnj.js"),__vite__mapDeps([19,1,2,4,8,3,5]))),ge=i.lazy(()=>g(()=>import("./Profile-CjQuK13W.js"),__vite__mapDeps([20,3,1,2,4,5]))),ye=i.lazy(()=>g(()=>import("./ShiftManagement-o7mLdxW8.js"),__vite__mapDeps([21,1,2,4,14,9,3,5]))),xe=i.lazy(()=>g(()=>import("./PayrollManagement-Q1itn8_j.js"),__vite__mapDeps([22,1,2,4,23,9,7,3,5]))),_e=i.lazy(()=>g(()=>import("./PaymentReports-gtaeXK9S.js"),__vite__mapDeps([24,1,2,4,23,9,3,5]))),ve=i.lazy(()=>g(()=>import("./DepartmentManagement-DYBktSyV.js"),__vite__mapDeps([25,1,2,4,9,3,5]))),je=i.lazy(()=>g(()=>import("./RoleManagement-DdTe5R3R.js"),__vite__mapDeps([26,1,2,4,9,3,5]))),Ee=i.lazy(()=>g(()=>import("./SystemSettings-kNoVhDlq.js"),__vite__mapDeps([27,1,2,4,3,5])));function Re(){const{user:e,isLoading:r}=M();if(r)return t.jsx(N,{});if(!e)return t.jsx(i.Suspense,{fallback:t.jsx(N,{}),children:t.jsxs(I,{children:[t.jsx(c,{path:"/login",element:t.jsx(ce,{})}),t.jsx(c,{path:"*",element:t.jsx(S,{to:"/login",replace:!0})})]})});const p=(e==null?void 0:e.role)==="SUPER_ADMIN"||(e==null?void 0:e.role)==="HR_MANAGER";return t.jsx(ie,{children:t.jsx(i.Suspense,{fallback:t.jsx(N,{}),children:t.jsxs(I,{children:[t.jsx(c,{path:"/",element:t.jsx(z,{})}),t.jsx(c,{path:"/dashboard",element:t.jsx(z,{})}),t.jsx(c,{path:"/profile",element:t.jsx(ge,{})}),p?t.jsxs(t.Fragment,{children:[t.jsx(c,{path:"/employees",element:t.jsx(le,{})}),t.jsx(c,{path:"/attendance",element:t.jsx(ue,{})}),t.jsx(c,{path:"/attendance-calendar",element:t.jsx(de,{})}),t.jsx(c,{path:"/attendance-reports",element:t.jsx(me,{})}),t.jsx(c,{path:"/leave",element:t.jsx(pe,{})}),t.jsx(c,{path:"/shifts",element:t.jsx(ye,{})}),t.jsx(c,{path:"/payroll",element:t.jsx(xe,{})}),t.jsx(c,{path:"/payment-reports",element:t.jsx(_e,{})}),t.jsx(c,{path:"/departments",element:t.jsx(ve,{})}),t.jsx(c,{path:"/roles",element:t.jsx(je,{})}),t.jsx(c,{path:"/settings",element:t.jsx(Ee,{})})]}):t.jsxs(t.Fragment,{children:[t.jsx(c,{path:"/my-attendance",element:t.jsx(fe,{})}),t.jsx(c,{path:"/my-leave",element:t.jsx(he,{})}),t.jsx(c,{path:"/attendance",element:t.jsx(S,{to:"/my-attendance",replace:!0})}),t.jsx(c,{path:"/leave",element:t.jsx(S,{to:"/my-leave",replace:!0})})]}),t.jsx(c,{path:"/login",element:t.jsx(S,{to:"/",replace:!0})}),t.jsx(c,{path:"*",element:t.jsx(S,{to:"/",replace:!0})})]})})})}const Pe=new Y({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});ne.createRoot(document.getElementById("root")).render(t.jsx(W.StrictMode,{children:t.jsx(X,{client:Pe,children:t.jsxs(H,{children:[t.jsx(Re,{}),t.jsx(Z,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{duration:5e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})})}));export{_ as a,L as b,Ne as c,t as j,M as u};
//# sourceMappingURL=index-DMnC-NiN.js.map
