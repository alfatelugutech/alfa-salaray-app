import{b as x,j as e}from"./index-j-xEUIA1.js";import{r as p}from"./router-BXhMSvr3.js";import{u as U,a as T,b as j}from"./query-DSXC375t.js";import{f as A,P as G,T as Q,z as m}from"./ui-BANi3Jhe.js";import"./vendor-C8w-UNLI.js";import"./utils-ngrFHoWO.js";const y={async getSettings(a){return(await x.get("/settings",{params:a})).data},async getSetting(a){return(await x.get(`/settings/${a}`)).data.data.setting},async createSetting(a){return(await x.post("/settings",a)).data.data.setting},async updateSetting(a,c){return(await x.put(`/settings/${a}`,c)).data.data.setting},async deleteSetting(a){await x.delete(`/settings/${a}`)},async getSettingsByCategory(a){return(await x.get(`/settings/category/${a}`)).data.data.settings},async bulkUpdateSettings(a){return(await x.put("/settings/bulk",{settings:a})).data.data.settings},async getSystemConfig(){return(await x.get("/settings/config/system")).data.data.config}},W=()=>{var k;const[a,c]=p.useState(!1),[d,n]=p.useState(null),[l,g]=p.useState(""),[i,o]=p.useState(""),[h,N]=p.useState(!1),[S,b]=p.useState({}),u=U(),{data:v,isLoading:O}=T({queryKey:["settings",l,i],queryFn:()=>y.getSettings({search:l,category:i,limit:100})}),{data:w}=T({queryKey:["system-config"],queryFn:y.getSystemConfig}),C=j({mutationFn:y.createSetting,onSuccess:()=>{u.invalidateQueries({queryKey:["settings"]}),u.invalidateQueries({queryKey:["system-config"]}),c(!1),m.success("Setting created successfully")},onError:t=>{var s,r;m.error(((r=(s=t.response)==null?void 0:s.data)==null?void 0:r.error)||"Failed to create setting")}}),E=j({mutationFn:({key:t,data:s})=>y.updateSetting(t,s),onSuccess:()=>{u.invalidateQueries({queryKey:["settings"]}),u.invalidateQueries({queryKey:["system-config"]}),n(null),m.success("Setting updated successfully")},onError:t=>{var s,r;m.error(((r=(s=t.response)==null?void 0:s.data)==null?void 0:r.error)||"Failed to update setting")}}),f=j({mutationFn:y.bulkUpdateSettings,onSuccess:()=>{u.invalidateQueries({queryKey:["settings"]}),u.invalidateQueries({queryKey:["system-config"]}),N(!1),b({}),m.success("Settings updated successfully")},onError:t=>{var s,r;m.error(((r=(s=t.response)==null?void 0:s.data)==null?void 0:r.error)||"Failed to update settings")}}),L=j({mutationFn:y.deleteSetting,onSuccess:()=>{u.invalidateQueries({queryKey:["settings"]}),u.invalidateQueries({queryKey:["system-config"]}),m.success("Setting deleted successfully")},onError:t=>{var s,r;m.error(((r=(s=t.response)==null?void 0:s.data)==null?void 0:r.error)||"Failed to delete setting")}}),q=t=>{C.mutate(t)},M=(t,s)=>{E.mutate({key:t,data:s})},R=()=>{const t=Object.entries(S).map(([s,r])=>({key:s,value:r}));f.mutate(t)},B=t=>{window.confirm("Are you sure you want to delete this setting?")&&L.mutate(t)},F=(t,s)=>{b(r=>({...r,[t]:s}))},I=t=>{switch(t){case"STRING":return"bg-blue-100 text-blue-800";case"NUMBER":return"bg-green-100 text-green-800";case"BOOLEAN":return"bg-purple-100 text-purple-800";case"JSON":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},K=(t,s)=>{if(s==="BOOLEAN")return t==="true"?"Yes":"No";if(s==="JSON")try{return JSON.stringify(JSON.parse(t),null,2)}catch{return t}return t};return O?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"System Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage system configuration and parameters"})]}),e.jsxs("div",{className:"flex space-x-3 mt-4 sm:mt-0",children:[e.jsxs("button",{onClick:()=>N(!h),className:`btn ${h?"btn-primary":"btn-secondary"}`,children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),h?"Exit Bulk Edit":"Bulk Edit"]}),e.jsxs("button",{onClick:()=>c(!0),className:"btn btn-primary",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Add Setting"]})]})]}),w&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"System Configuration"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(w).map(([t,s])=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t}),e.jsx("div",{className:"text-sm text-gray-600",children:typeof s=="object"?JSON.stringify(s):String(s)})]},t))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search settings...",value:l,onChange:t=>g(t.target.value),className:"input w-full"})}),e.jsxs("select",{value:i,onChange:t=>o(t.target.value),className:"input w-full sm:w-48",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"SYSTEM",children:"System"}),e.jsx("option",{value:"GENERAL",children:"General"}),e.jsx("option",{value:"SECURITY",children:"Security"}),e.jsx("option",{value:"NOTIFICATIONS",children:"Notifications"}),e.jsx("option",{value:"PAYROLL",children:"Payroll"}),e.jsx("option",{value:"ATTENDANCE",children:"Attendance"})]})]}),h&&e.jsx("div",{className:"card p-4 bg-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"Bulk Edit Mode"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Edit multiple settings at once"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{N(!1),b({})},className:"btn btn-secondary btn-sm",children:"Cancel"}),e.jsx("button",{onClick:R,className:"btn btn-primary btn-sm",disabled:f.isLoading,children:f.isLoading?"Saving...":"Save All"})]})]})}),e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Key"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Value"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(k=v==null?void 0:v.data.settings)==null?void 0:k.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.key})}),e.jsx("td",{className:"px-6 py-4",children:h?e.jsx("input",{type:"text",value:S[t.key]||t.value,onChange:s=>F(t.key,s.target.value),className:"input w-full"}):e.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:K(t.value,t.type)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${I(t.type)}`,children:t.type})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.category||"General"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:!h&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>n(t),className:"text-blue-600 hover:text-blue-900",children:e.jsx(A,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>B(t.key),className:"text-red-600 hover:text-red-900",children:e.jsx(Q,{className:"w-4 h-4"})})]})})]},t.id))})]})})}),a&&e.jsx(Y,{onClose:()=>c(!1),onSubmit:q,isLoading:C.isLoading}),d&&e.jsx(D,{setting:d,onClose:()=>n(null),onSubmit:t=>M(d.key,t),isLoading:E.isLoading})]})},Y=({onClose:a,onSubmit:c,isLoading:d})=>{const[n,l]=p.useState({key:"",value:"",type:"STRING",category:"GENERAL"}),g=i=>{i.preventDefault(),c(n)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create New Setting"}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Key"}),e.jsx("input",{type:"text",value:n.key,onChange:i=>l({...n,key:i.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Value"}),e.jsx("textarea",{value:n.value,onChange:i=>l({...n,value:i.target.value}),className:"input",rows:3,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Type"}),e.jsxs("select",{value:n.type,onChange:i=>l({...n,type:i.target.value}),className:"input",required:!0,children:[e.jsx("option",{value:"STRING",children:"String"}),e.jsx("option",{value:"NUMBER",children:"Number"}),e.jsx("option",{value:"BOOLEAN",children:"Boolean"}),e.jsx("option",{value:"JSON",children:"JSON"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Category"}),e.jsxs("select",{value:n.category,onChange:i=>l({...n,category:i.target.value}),className:"input",children:[e.jsx("option",{value:"GENERAL",children:"General"}),e.jsx("option",{value:"SYSTEM",children:"System"}),e.jsx("option",{value:"SECURITY",children:"Security"}),e.jsx("option",{value:"NOTIFICATIONS",children:"Notifications"}),e.jsx("option",{value:"PAYROLL",children:"Payroll"}),e.jsx("option",{value:"ATTENDANCE",children:"Attendance"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:a,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:d,children:d?"Creating...":"Create Setting"})]})]})]})})},D=({setting:a,onClose:c,onSubmit:d,isLoading:n})=>{const[l,g]=p.useState({value:a.value,type:a.type,category:a.category}),i=o=>{o.preventDefault(),d(l)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Setting"}),e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Key"}),e.jsx("input",{type:"text",value:a.key,className:"input",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Value"}),e.jsx("textarea",{value:l.value,onChange:o=>g({...l,value:o.target.value}),className:"input",rows:3,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Type"}),e.jsxs("select",{value:l.type,onChange:o=>g({...l,type:o.target.value}),className:"input",required:!0,children:[e.jsx("option",{value:"STRING",children:"String"}),e.jsx("option",{value:"NUMBER",children:"Number"}),e.jsx("option",{value:"BOOLEAN",children:"Boolean"}),e.jsx("option",{value:"JSON",children:"JSON"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Category"}),e.jsxs("select",{value:l.category,onChange:o=>g({...l,category:o.target.value}),className:"input",children:[e.jsx("option",{value:"GENERAL",children:"General"}),e.jsx("option",{value:"SYSTEM",children:"System"}),e.jsx("option",{value:"SECURITY",children:"Security"}),e.jsx("option",{value:"NOTIFICATIONS",children:"Notifications"}),e.jsx("option",{value:"PAYROLL",children:"Payroll"}),e.jsx("option",{value:"ATTENDANCE",children:"Attendance"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:c,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:n,children:n?"Updating...":"Update Setting"})]})]})]})})};export{W as default};
//# sourceMappingURL=SystemSettings-CpQ050sC.js.map
