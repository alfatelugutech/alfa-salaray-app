const d=()=>new Promise((e,t)=>{if(!navigator.geolocation){t(new Error("Geolocation is not supported by your browser"));return}navigator.geolocation.getCurrentPosition(a=>{e({latitude:a.coords.latitude,longitude:a.coords.longitude,accuracy:a.coords.accuracy})},a=>{let r="Unable to retrieve location";switch(a.code){case a.PERMISSION_DENIED:r="Location permission denied. Please enable location access.";break;case a.POSITION_UNAVAILABLE:r="Location information is unavailable.";break;case a.TIMEOUT:r="Location request timed out.";break}t(new Error(r))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),m=async(e,t)=>{try{return(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e}&lon=${t}&zoom=18&addressdetails=1`,{headers:{"User-Agent":"Employee Attendance System"}})).json()).display_name||`${e.toFixed(6)}, ${t.toFixed(6)}`}catch{return`${e.toFixed(6)}, ${t.toFixed(6)}`}},u=async()=>{const e=await d(),t=await m(e.latitude,e.longitude);return{...e,address:t}},f=()=>{const e=navigator.userAgent;let t="desktop";/mobile/i.test(e)?t="mobile":/tablet|ipad/i.test(e)&&(t="tablet");let a="Unknown";/windows/i.test(e)?a="Windows":/mac/i.test(e)?a="macOS":/linux/i.test(e)?a="Linux":/android/i.test(e)?a="Android":/ios|iphone|ipad/i.test(e)&&(a="iOS");let r="Unknown";return/edg/i.test(e)?r="Edge":/chrome/i.test(e)&&!/edg/i.test(e)?r="Chrome":/firefox/i.test(e)?r="Firefox":/safari/i.test(e)&&!/chrome/i.test(e)&&(r="Safari"),{deviceType:t,os:a,browser:r,userAgent:e}},c=()=>!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),h=async()=>{try{return c()?((await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(t=>t.stop()),{hasPermission:!0,message:"Camera access granted successfully!"}):{hasPermission:!1,message:"Camera is not available on this device. Please use a device with a camera."}}catch(e){console.error("❌ Camera permission check failed:",e);let t="Camera access failed";return e.name==="NotAllowedError"?t='Camera permission denied. Please click "Allow" when prompted for camera access.':e.name==="NotFoundError"?t="No camera found. Please check if your device has a camera.":e.name==="NotReadableError"?t="Camera is being used by another app. Please close other camera applications.":t=`Camera error: ${e.message||"Unknown error"}`,{hasPermission:!1,message:t}}},w=async()=>new Promise(async(e,t)=>{if(!c()){t(new Error("Camera is not available on this device"));return}let a=null;try{try{a=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:600,min:300},height:{ideal:600,min:300}}})}catch(i){console.log("⚠️ Strict constraints failed, trying relaxed constraints:",i);try{a=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}})}catch(l){console.log("⚠️ Relaxed constraints failed, trying basic video:",l),a=await navigator.mediaDevices.getUserMedia({video:!0})}}const r=document.createElement("video");r.srcObject=a,r.autoplay=!0,await r.play(),await new Promise(i=>setTimeout(i,500));const s=document.createElement("canvas");s.width=600,s.height=600;const o=s.getContext("2d");o&&o.drawImage(r,0,0,s.width,s.height),a&&a.getTracks().forEach(i=>i.stop());const n=s.toDataURL("image/jpeg",.8);e(n)}catch(r){a&&a.getTracks().forEach(o=>o.stop()),console.error("❌ Camera capture error:",r);let s="Failed to capture photo";r.name==="NotAllowedError"?s="Camera permission denied. Please allow camera access and try again.":r.name==="NotFoundError"?s="No camera found on this device. Please check your camera connection.":r.name==="NotReadableError"?s="Camera is already in use by another application. Please close other camera apps and try again.":r.name==="OverconstrainedError"?s="Camera constraints not supported. Please try again.":r.name==="AbortError"?s="Camera access was interrupted. Please try again.":s=`Camera error: ${r.message||"Unknown error"}`,t(new Error(s))}}),p=async e=>new Promise((t,a)=>{if(!e.type.startsWith("image/")){a(new Error("Please select a valid image file"));return}const r=5*1024*1024;if(e.size>r){a(new Error("Image size must be less than 5MB"));return}const s=new FileReader;s.onload=o=>{var i;const n=(i=o.target)==null?void 0:i.result;t(n)},s.onerror=()=>{a(new Error("Failed to read image file"))},s.readAsDataURL(e)}),g=async e=>new Promise(t=>{const a=new Image;a.onload=()=>{const r=document.createElement("canvas");r.width=600,r.height=600;const s=r.getContext("2d");s&&s.drawImage(a,0,0,600,600);const o=r.toDataURL("image/jpeg",.9);t(o)},a.src=e}),v=async e=>g(e);export{f as a,w as b,h as c,g as d,v as e,u as g,c as i,p as s};
//# sourceMappingURL=camera-uGge9r08.js.map
