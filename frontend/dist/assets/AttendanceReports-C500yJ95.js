import{j as e}from"./index-mRQHkU_F.js";import{r as N}from"./router-BXhMSvr3.js";import{a as w}from"./query-DSXC375t.js";import{a as I}from"./attendanceService-VqJNCveG.js";import{e as F}from"./employeeService-DwRPqA0A.js";import{e as S,c as M,d as O,a as Y,n as P}from"./ui-phtE4UZ1.js";import"./vendor-C8w-UNLI.js";import"./utils-ngrFHoWO.js";const G=()=>{var f,b,v,y;const[r,D]=N.useState(new Date().toISOString().slice(0,7)),[c,A]=N.useState("all"),[V,_]=N.useState(null),{data:u}=w("employees",()=>F.getEmployees({page:1,limit:1e3})),{data:t,isLoading:E}=w(["attendance-reports",r,c],()=>{const s=new Date(r+"-01"),a=new Date(s.getFullYear(),s.getMonth()+1,0);return I.getAttendance({startDate:s.toISOString().split("T")[0],endDate:a.toISOString().split("T")[0],employeeId:c!=="all"?c:void 0})},{onSuccess:s=>{var a;console.log("ðŸ“Š Attendance Reports Data:",{selectedMonth:r,selectedEmployee:c,data:s,attendances:(a=s==null?void 0:s.data)==null?void 0:a.attendances})}}),C=()=>{var g,m,l;const s=parseInt(r.split("-")[0]),a=parseInt(r.split("-")[1])-1,i=new Date(s,a,1),h=new Date(s,a+1,0),o=[],d=new Date(i),j=i.getDay();for(let x=0;x<j;x++)o.push({date:null,attendance:null});for(;d<=h;){const x=d.toISOString().split("T")[0],p=(m=(g=t==null?void 0:t.data)==null?void 0:g.attendances)==null?void 0:m.find(R=>new Date(R.date).toISOString().split("T")[0]===x);console.log("ðŸ“… Calendar day:",{date:x,hasAttendance:!!p,attendance:p,allAttendances:(l=t==null?void 0:t.data)==null?void 0:l.attendances}),o.push({date:new Date(d),attendance:p}),d.setDate(d.getDate()+1)}return o},L=s=>{switch(s){case"PRESENT":return"bg-green-500";case"LATE":return"bg-yellow-500";case"ABSENT":return"bg-red-500";case"HALF_DAY":return"bg-blue-500";case"EARLY_LEAVE":return"bg-orange-500";default:return"bg-gray-300"}},n=(()=>{var m;if(!((m=t==null?void 0:t.data)!=null&&m.attendances))return null;const s=t.data.attendances,a=s.length,i=s.filter(l=>l.status==="PRESENT").length,h=s.filter(l=>l.status==="LATE").length,o=s.filter(l=>l.status==="ABSENT").length,d=s.filter(l=>l.status==="HALF_DAY").length,j=s.filter(l=>l.status==="EARLY_LEAVE").length,g=a>0?(i+h)/a*100:0;return{totalDays:a,presentCount:i,lateCount:h,absentCount:o,halfDayCount:d,earlyLeaveCount:j,attendanceRate:g}})(),T=C();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Attendance Reports"}),e.jsx("p",{className:"text-gray-600",children:"Visual attendance tracking and analytics"})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:new Date(r+"-01").toLocaleDateString("en-US",{year:"numeric",month:"long"})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Select Month"}),e.jsx("input",{type:"month",value:r,onChange:s=>D(s.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Select Employee"}),e.jsxs("select",{value:c,onChange:s=>A(s.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"All Employees"}),(b=(f=u==null?void 0:u.data)==null?void 0:f.employees)==null?void 0:b.map(s=>e.jsxs("option",{value:s.id,children:[s.user.firstName," ",s.user.lastName]},s.id))]})]})]}),n&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Days"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.totalDays})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(S,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Present"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.presentCount})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(M,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Late"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:n.lateCount})]}),e.jsx("div",{className:"p-3 bg-yellow-100 rounded-full",children:e.jsx(O,{className:"w-6 h-6 text-yellow-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Absent"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:n.absentCount})]}),e.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:e.jsx(Y,{className:"w-6 h-6 text-red-600"})})]})})]}),n&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Attendance Rate"}),e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[n.attendanceRate.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"bg-blue-600 h-4 rounded-full transition-all duration-300",style:{width:`${n.attendanceRate}%`}})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"Monthly Calendar View"]})}),e.jsx("div",{className:"p-6",children:E?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Loading attendance data..."})]}):(y=(v=t==null?void 0:t.data)==null?void 0:v.attendances)!=null&&y.length?e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(s=>e.jsx("div",{className:"p-2 text-center text-sm font-medium text-gray-500",children:s},s)),T.map((s,a)=>e.jsx("div",{className:`p-2 min-h-[60px] border rounded-lg flex flex-col items-center justify-center relative ${s.date?"bg-white hover:bg-gray-50 cursor-pointer":"bg-gray-50"}`,children:s.date&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.date.getDate()}),s.attendance?e.jsxs("div",{className:"mt-1 flex flex-col items-center",children:[e.jsx("div",{className:`w-4 h-4 rounded-full ${L(s.attendance.status)} shadow-sm`}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:s.attendance.status})]}):e.jsx("div",{className:"mt-1",children:e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-200"})})]})},a))]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(S,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No attendance data found for this month"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Try selecting a different month or employee"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Legend"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Present"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Late"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Absent"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Half Day"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Early Leave"})]})]})]})]})};export{G as default};
//# sourceMappingURL=AttendanceReports-C500yJ95.js.map
