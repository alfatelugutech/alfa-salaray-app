import{b as N,j as e}from"./index-DwF7U1DN.js";import{r as u}from"./router-BXhMSvr3.js";import{u as I,a as A,b as E}from"./query-DSXC375t.js";import{p as L}from"./payrollSettingsService-dqEjOfXS.js";import{G as O,I as H,J,q as $,C as z,D as q,N as V,z as p,f as F,P as X,T as _}from"./ui-6VNF3JfZ.js";import"./vendor-C8w-UNLI.js";import"./utils-ngrFHoWO.js";const b={async getSettings(t){return(await N.get("/settings",{params:t})).data},async getSetting(t){return(await N.get(`/settings/${t}`)).data.data.setting},async createSetting(t){return(await N.post("/settings",t)).data.data.setting},async updateSetting(t,n){return(await N.put(`/settings/${t}`,n)).data.data.setting},async deleteSetting(t){await N.delete(`/settings/${t}`)},async getSettingsByCategory(t){return(await N.get(`/settings/category/${t}`)).data.data.settings},async bulkUpdateSettings(t){return(await N.put("/settings/bulk",{settings:t})).data.data.settings},async getSystemConfig(){return(await N.get("/settings/config/system")).data.data.config}},W=()=>{var M;const[t,n]=u.useState({}),[x,c]=u.useState([]),[r,m]=u.useState(!1),d=I(),{data:i,isLoading:f}=A("payroll-settings",L.getSettings),{data:S,isLoading:j}=A("payroll-methods",L.getMethods),v=E(L.updateSettings,{onSuccess:()=>{d.invalidateQueries("payroll-settings"),m(!1),p.success("Payroll settings updated successfully!")},onError:a=>{var g,y;p.error(((y=(g=a.response)==null?void 0:g.data)==null?void 0:y.error)||"Failed to update settings")}});u.useEffect(()=>{i&&n(i)},[i]),u.useEffect(()=>{S&&c(S)},[S]);const k=()=>{v.mutate(t)},C=()=>{i&&(n(i),m(!1))},h=a=>{const g=x.find(y=>y.value===a);return(g==null?void 0:g.icon)||"ðŸ’°"},w=a=>{const g=x.find(y=>y.value===a);return(g==null?void 0:g.label)||a};return f||j?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(O,{className:"h-6 w-6"}),"Payroll Settings"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Configure payroll calculation methods and system-wide settings"})]}),e.jsx("div",{className:"flex gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:C,className:"btn btn-secondary flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),"Reset"]}),e.jsxs("button",{onClick:k,disabled:v.isLoading,className:"btn btn-primary flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),v.isLoading?"Saving...":"Save Changes"]})]}):e.jsxs("button",{onClick:()=>m(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),"Edit Settings"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5"}),"Default Calculation Method"]})}),e.jsx("div",{className:"card-body",children:r?e.jsx("select",{value:t.defaultMethod||"FIXED_SALARY",onChange:a=>n({...t,defaultMethod:a.target.value}),className:"input w-full",children:x.map(a=>e.jsxs("option",{value:a.value,children:[a.icon," ",a.label]},a.value))}):e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:h(t.defaultMethod||"FIXED_SALARY")}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:w(t.defaultMethod||"FIXED_SALARY")}),e.jsx("div",{className:"text-sm text-gray-600",children:(M=x.find(a=>a.value===t.defaultMethod))==null?void 0:M.description})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"Overtime Configuration"]})}),e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Overtime Multiplier"}),r?e.jsx("input",{type:"number",value:t.overtimeMultiplier||1.5,onChange:a=>n({...t,overtimeMultiplier:Number(a.target.value)}),className:"input",min:"1.0",max:"3.0",step:"0.1"}):e.jsxs("div",{className:"text-lg font-semibold text-blue-600",children:[t.overtimeMultiplier||1.5,"x"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Multiplier for overtime hours (e.g., 1.5x means 50% extra pay)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Overtime Threshold (hours per day)"}),r?e.jsx("input",{type:"number",value:t.overtimeThreshold||8,onChange:a=>n({...t,overtimeThreshold:Number(a.target.value)}),className:"input",min:"4",max:"12"}):e.jsxs("div",{className:"text-lg font-semibold text-orange-600",children:[t.overtimeThreshold||8," hours"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Hours after which overtime rate applies"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),"Regular Hours Configuration"]})}),e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Regular Hours Per Month"}),r?e.jsx("input",{type:"number",value:t.regularHoursPerMonth||160,onChange:a=>n({...t,regularHoursPerMonth:Number(a.target.value)}),className:"input",min:"80",max:"200"}):e.jsxs("div",{className:"text-lg font-semibold text-green-600",children:[t.regularHoursPerMonth||160," hours"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Standard working hours per month (40 hours/week Ã— 4 weeks)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Regular Hours Per Day"}),r?e.jsx("input",{type:"number",value:t.regularHoursPerDay||8,onChange:a=>n({...t,regularHoursPerDay:Number(a.target.value)}),className:"input",min:"4",max:"12"}):e.jsxs("div",{className:"text-lg font-semibold text-purple-600",children:[t.regularHoursPerDay||8," hours"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Standard working hours per day"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5"}),"Available Calculation Methods"]})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"space-y-3",children:x.map(a=>e.jsx("div",{className:`p-3 rounded-lg border ${t.defaultMethod===a.value?"border-blue-500 bg-blue-50":"border-gray-200 bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:a.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.label}),e.jsx("div",{className:"text-sm text-gray-600",children:a.description}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.jsx("strong",{children:"Calculation:"})," ",a.calculation]})]}),t.defaultMethod===a.value&&e.jsx("div",{className:"text-blue-600 font-medium text-sm",children:"Current"})]})},a.value))})})]})]}),i&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Settings Information"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Last Updated:"}),e.jsx("div",{className:"font-medium",children:new Date(i.updatedAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Updated By:"}),e.jsxs("div",{className:"font-medium",children:[i.updatedByUser.firstName," ",i.updatedByUser.lastName]})]})]})})]})]})},ce=()=>{var R;const[t,n]=u.useState("general"),[x,c]=u.useState(!1),[r,m]=u.useState(null),[d,i]=u.useState(""),[f,S]=u.useState(""),[j,v]=u.useState(!1),[k,C]=u.useState({}),h=I(),{data:w,isLoading:M}=A({queryKey:["settings",d,f],queryFn:()=>b.getSettings({search:d,category:f,limit:100})}),{data:a}=A({queryKey:["system-config"],queryFn:b.getSystemConfig}),g=E({mutationFn:b.createSetting,onSuccess:()=>{h.invalidateQueries({queryKey:["settings"]}),h.invalidateQueries({queryKey:["system-config"]}),c(!1),p.success("Setting created successfully")},onError:s=>{var l,o;p.error(((o=(l=s.response)==null?void 0:l.data)==null?void 0:o.error)||"Failed to create setting")}}),y=E({mutationFn:({key:s,data:l})=>b.updateSetting(s,l),onSuccess:()=>{h.invalidateQueries({queryKey:["settings"]}),h.invalidateQueries({queryKey:["system-config"]}),m(null),p.success("Setting updated successfully")},onError:s=>{var l,o;p.error(((o=(l=s.response)==null?void 0:l.data)==null?void 0:o.error)||"Failed to update setting")}}),T=E({mutationFn:b.bulkUpdateSettings,onSuccess:()=>{h.invalidateQueries({queryKey:["settings"]}),h.invalidateQueries({queryKey:["system-config"]}),v(!1),C({}),p.success("Settings updated successfully")},onError:s=>{var l,o;p.error(((o=(l=s.response)==null?void 0:l.data)==null?void 0:o.error)||"Failed to update settings")}}),P=E({mutationFn:b.deleteSetting,onSuccess:()=>{h.invalidateQueries({queryKey:["settings"]}),h.invalidateQueries({queryKey:["system-config"]}),p.success("Setting deleted successfully")},onError:s=>{var l,o;p.error(((o=(l=s.response)==null?void 0:l.data)==null?void 0:o.error)||"Failed to delete setting")}}),B=s=>{g.mutate(s)},D=(s,l)=>{y.mutate({key:s,data:l})},U=()=>{const s=Object.entries(k).map(([l,o])=>({key:l,value:o}));T.mutate(s)},G=s=>{window.confirm("Are you sure you want to delete this setting?")&&P.mutate(s)},K=(s,l)=>{C(o=>({...o,[s]:l}))},Y=s=>{switch(s){case"STRING":return"bg-blue-100 text-blue-800";case"NUMBER":return"bg-green-100 text-green-800";case"BOOLEAN":return"bg-purple-100 text-purple-800";case"JSON":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},Q=(s,l)=>{if(l==="BOOLEAN")return s==="true"?"Yes":"No";if(l==="JSON")try{return JSON.stringify(JSON.parse(s),null,2)}catch{return s}return s};return M?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"System Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage system configuration and parameters"})]}),e.jsxs("div",{className:"flex space-x-3 mt-4 sm:mt-0",children:[e.jsxs("button",{onClick:()=>v(!j),className:`btn ${j?"btn-primary":"btn-secondary"}`,children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),j?"Exit Bulk Edit":"Bulk Edit"]}),e.jsxs("button",{onClick:()=>c(!0),className:"btn btn-primary",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Add Setting"]})]})]}),a&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"System Configuration"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(a).map(([s,l])=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s}),e.jsx("div",{className:"text-sm text-gray-600",children:typeof l=="object"?JSON.stringify(l):String(l)})]},s))})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{onClick:()=>n("general"),className:`py-2 px-1 border-b-2 font-medium text-sm ${t==="general"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(O,{className:"h-4 w-4 inline mr-2"}),"General Settings"]}),e.jsxs("button",{onClick:()=>n("payroll"),className:`py-2 px-1 border-b-2 font-medium text-sm ${t==="payroll"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(q,{className:"h-4 w-4 inline mr-2"}),"Payroll Settings"]})]})}),t==="payroll"?e.jsx(W,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search settings...",value:d,onChange:s=>i(s.target.value),className:"input w-full"})}),e.jsxs("select",{value:f,onChange:s=>S(s.target.value),className:"input w-full sm:w-48",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"SYSTEM",children:"System"}),e.jsx("option",{value:"GENERAL",children:"General"}),e.jsx("option",{value:"SECURITY",children:"Security"}),e.jsx("option",{value:"NOTIFICATIONS",children:"Notifications"}),e.jsx("option",{value:"PAYROLL",children:"Payroll"}),e.jsx("option",{value:"ATTENDANCE",children:"Attendance"})]})]}),j&&e.jsx("div",{className:"card p-4 bg-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"Bulk Edit Mode"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Edit multiple settings at once"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{v(!1),C({})},className:"btn btn-secondary btn-sm",children:"Cancel"}),e.jsx("button",{onClick:U,className:"btn btn-primary btn-sm",disabled:T.isLoading,children:T.isLoading?"Saving...":"Save All"})]})]})}),e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Key"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Value"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(R=w==null?void 0:w.data.settings)==null?void 0:R.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.key})}),e.jsx("td",{className:"px-6 py-4",children:j?e.jsx("input",{type:"text",value:k[s.key]||s.value,onChange:l=>K(s.key,l.target.value),className:"input w-full"}):e.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:Q(s.value,s.type)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Y(s.type)}`,children:s.type})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.category||"General"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:!j&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>m(s),className:"text-blue-600 hover:text-blue-900",children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>G(s.key),className:"text-red-600 hover:text-red-900",children:e.jsx(_,{className:"w-4 h-4"})})]})})]},s.id))})]})})}),x&&e.jsx(Z,{onClose:()=>c(!1),onSubmit:B,isLoading:g.isLoading}),r&&e.jsx(ee,{setting:r,onClose:()=>m(null),onSubmit:s=>D(r.key,s),isLoading:y.isLoading})]})]})},Z=({onClose:t,onSubmit:n,isLoading:x})=>{const[c,r]=u.useState({key:"",value:"",type:"STRING",category:"GENERAL"}),m=d=>{d.preventDefault(),n(c)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create New Setting"}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Key"}),e.jsx("input",{type:"text",value:c.key,onChange:d=>r({...c,key:d.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Value"}),e.jsx("textarea",{value:c.value,onChange:d=>r({...c,value:d.target.value}),className:"input",rows:3,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Type"}),e.jsxs("select",{value:c.type,onChange:d=>r({...c,type:d.target.value}),className:"input",required:!0,children:[e.jsx("option",{value:"STRING",children:"String"}),e.jsx("option",{value:"NUMBER",children:"Number"}),e.jsx("option",{value:"BOOLEAN",children:"Boolean"}),e.jsx("option",{value:"JSON",children:"JSON"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Category"}),e.jsxs("select",{value:c.category,onChange:d=>r({...c,category:d.target.value}),className:"input",children:[e.jsx("option",{value:"GENERAL",children:"General"}),e.jsx("option",{value:"SYSTEM",children:"System"}),e.jsx("option",{value:"SECURITY",children:"Security"}),e.jsx("option",{value:"NOTIFICATIONS",children:"Notifications"}),e.jsx("option",{value:"PAYROLL",children:"Payroll"}),e.jsx("option",{value:"ATTENDANCE",children:"Attendance"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:t,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:x,children:x?"Creating...":"Create Setting"})]})]})]})})},ee=({setting:t,onClose:n,onSubmit:x,isLoading:c})=>{const[r,m]=u.useState({value:t.value,type:t.type,category:t.category}),d=i=>{i.preventDefault(),x(r)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Setting"}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Key"}),e.jsx("input",{type:"text",value:t.key,className:"input",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Value"}),e.jsx("textarea",{value:r.value,onChange:i=>m({...r,value:i.target.value}),className:"input",rows:3,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Type"}),e.jsxs("select",{value:r.type,onChange:i=>m({...r,type:i.target.value}),className:"input",required:!0,children:[e.jsx("option",{value:"STRING",children:"String"}),e.jsx("option",{value:"NUMBER",children:"Number"}),e.jsx("option",{value:"BOOLEAN",children:"Boolean"}),e.jsx("option",{value:"JSON",children:"JSON"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Category"}),e.jsxs("select",{value:r.category,onChange:i=>m({...r,category:i.target.value}),className:"input",children:[e.jsx("option",{value:"GENERAL",children:"General"}),e.jsx("option",{value:"SYSTEM",children:"System"}),e.jsx("option",{value:"SECURITY",children:"Security"}),e.jsx("option",{value:"NOTIFICATIONS",children:"Notifications"}),e.jsx("option",{value:"PAYROLL",children:"Payroll"}),e.jsx("option",{value:"ATTENDANCE",children:"Attendance"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:n,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:c,children:c?"Updating...":"Update Setting"})]})]})]})})};export{ce as default};
//# sourceMappingURL=SystemSettings-DXhptZqH.js.map
