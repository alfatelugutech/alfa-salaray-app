const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-s7ezhjsn.js","assets/router-BXhMSvr3.js","assets/vendor-C8w-UNLI.js","assets/ui-CenJk824.js","assets/query-DSXC375t.js","assets/utils-ngrFHoWO.js","assets/Dashboard-B8DGAwS2.js","assets/attendanceService-B_f8hz7J.js","assets/leaveService-FQ1hqWgu.js","assets/employeeService-CK3_iFt-.js","assets/camera-DOUdOm2H.js","assets/locationTrackingService-RRqZCVns.js","assets/Employees-Bdz9ONmQ.js","assets/Attendance-DWfwe2Cl.js","assets/shiftService-8kbvWAu4.js","assets/AttendanceCalendar-073ilu4D.js","assets/AttendanceReports-DAACFgZ-.js","assets/LeaveRequests-D8Edusqy.js","assets/MyAttendance-D2Me9Oi1.js","assets/MyLeave-BuU8D_F3.js","assets/Profile-CeJynsGf.js","assets/ShiftManagement-Bqyi5Efv.js","assets/PayrollManagement-0PnWnSCu.js","assets/payrollService-vuYsi992.js","assets/PaymentReports-BN26F2Wa.js","assets/SystemSettings-Cko1Scjf.js"])))=>i.map(i=>d[i]);
import{r as V,a as F,g as B}from"./vendor-C8w-UNLI.js";import{r as l,u as $,L as y,b as w,c as u,N as E,a as J,B as Q}from"./router-BXhMSvr3.js";import{u as W,a as K,b as D,Q as G,c as H}from"./query-DSXC375t.js";import{z as f,F as Y}from"./ui-CenJk824.js";import{a as X}from"./utils-ngrFHoWO.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))_(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&_(i)}).observe(document,{childList:!0,subtree:!0});function p(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function _(n){if(n.ep)return;n.ep=!0;const a=p(n);fetch(n.href,a)}})();var P={exports:{}},S={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T;function Z(){if(T)return S;T=1;var t=V(),r=Symbol.for("react.element"),p=Symbol.for("react.fragment"),_=Object.prototype.hasOwnProperty,n=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(o,d,m){var c,h={},g=null,s=null;m!==void 0&&(g=""+m),d.key!==void 0&&(g=""+d.key),d.ref!==void 0&&(s=d.ref);for(c in d)_.call(d,c)&&!a.hasOwnProperty(c)&&(h[c]=d[c]);if(o&&o.defaultProps)for(c in d=o.defaultProps,d)h[c]===void 0&&(h[c]=d[c]);return{$$typeof:r,type:o,key:g,ref:s,props:h,_owner:n.current}}return S.Fragment=p,S.jsx=i,S.jsxs=i,S}var U;function ee(){return U||(U=1,P.exports=Z()),P.exports}var e=ee(),L={},C;function te(){if(C)return L;C=1;var t=F();return L.createRoot=t.createRoot,L.hydrateRoot=t.hydrateRoot,L}var re=te();const se=B(re),ne="modulepreload",oe=function(t){return"/"+t},q={},x=function(r,p,_){let n=Promise.resolve();if(p&&p.length>0){let i=function(m){return Promise.all(m.map(c=>Promise.resolve(c).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),d=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=i(p.map(m=>{if(m=oe(m),m in q)return;q[m]=!0;const c=m.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${h}`))return;const g=document.createElement("link");if(g.rel=c?"stylesheet":ne,c||(g.as="script"),g.crossOrigin="",g.href=m,d&&g.setAttribute("nonce",d),document.head.appendChild(g),c)return new Promise((s,v)=>{g.addEventListener("load",s),g.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${m}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return n.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return r().catch(a)})},A="http://localhost:5000/api",N=X.create({baseURL:A,timeout:1e4,headers:{"Content-Type":"application/json"}});N.interceptors.request.use(t=>{const r=localStorage.getItem("token");return r&&(t.headers.Authorization=`Bearer ${r}`),t},t=>Promise.reject(t));N.interceptors.response.use(t=>t,t=>{var p,_,n,a,i,o,d,m,c,h;if(((p=t.response)==null?void 0:p.status)===401)return localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login",Promise.reject(t);if(t.code==="ECONNABORTED"||t.message.includes("timeout"))return console.error("Request timeout - backend is not responding"),f.error("Cannot connect to server. Please ensure the backend is running at "+A.replace("/api","")),Promise.reject(t);if(t.code==="NETWORK_ERROR"||t.message==="Network Error"||t.code==="ERR_NETWORK")return console.error("Network error - backend may be unavailable at:",A),f.error("Cannot connect to server. Please check if the backend is running."),Promise.reject(t);if(((_=t.response)==null?void 0:_.status)===429)return console.warn("Rate limit exceeded - backend may be temporarily unavailable"),f.error("Server is busy - please try again in a few minutes"),Promise.reject(t);if(((n=t.response)==null?void 0:n.status)>=500)return console.error("Server error:",(a=t.response)==null?void 0:a.data),f.error("Server error - please try again later"),Promise.reject(t);if(((i=t.response)==null?void 0:i.status)>=400&&((o=t.response)==null?void 0:o.status)<500){const g=((m=(d=t.response)==null?void 0:d.data)==null?void 0:m.error)||"Request failed";return f.error(g),Promise.reject(t)}const r=((h=(c=t.response)==null?void 0:c.data)==null?void 0:h.error)||t.message||"An error occurred";return f.error(r),Promise.reject(t)});const j={async login(t){const r=await N.post("/auth/login",t);return{user:r.data.data.user,token:r.data.data.token}},async register(t){const r=await N.post("/auth/register",t);return{user:r.data.data.user,token:r.data.data.token}},async getCurrentUser(){return(await N.get("/auth/me")).data.data.user},logout(){localStorage.removeItem("token"),localStorage.removeItem("user")},isAuthenticated(){try{const t=localStorage.getItem("token");return!(!t||t==="undefined"||t==="null"||t==="")}catch(t){return console.error("Error checking authentication:",t),!1}},getStoredUser(){try{const t=localStorage.getItem("user");return!t||t==="undefined"||t==="null"||t===""?null:t==="undefined"||t==="null"?(localStorage.removeItem("user"),localStorage.removeItem("token"),null):JSON.parse(t)}catch(t){return console.error("Error parsing stored user:",t),localStorage.removeItem("user"),localStorage.removeItem("token"),null}},storeUser(t,r){localStorage.setItem("user",JSON.stringify(t)),localStorage.setItem("token",r)}},M=()=>{const[t,r]=l.useState(null),[p,_]=l.useState(!0),n=W(),a=$();l.useEffect(()=>{try{const s=j.getStoredUser();s&&j.isAuthenticated()&&r(s)}catch(s){console.error("Error initializing auth:",s),j.logout()}finally{_(!1)}},[]);const{data:i,isLoading:o}=K("currentUser",j.getCurrentUser,{enabled:!!t&&j.isAuthenticated(),retry:!1,onError:()=>{j.logout(),r(null)}});l.useEffect(()=>{i&&(r(i),j.storeUser(i,localStorage.getItem("token")))},[i]);const d=D(j.login,{onSuccess:s=>{j.storeUser(s.user,s.token),r(s.user),n.invalidateQueries("currentUser"),f.success("Login successful!"),a("/dashboard")},onError:s=>{var v,R,O,I,k;console.error("Login error:",s),((v=s.response)==null?void 0:v.status)===429?f.error("Server is busy - please try again in a few minutes"):((R=s.response)==null?void 0:R.status)===401?f.error("Invalid email or password"):((O=s.response)==null?void 0:O.status)===0||s.code==="NETWORK_ERROR"?f.error("Cannot connect to server - please check your internet connection"):f.error(((k=(I=s.response)==null?void 0:I.data)==null?void 0:k.error)||"Login failed")}}),m=D(j.register,{onSuccess:s=>{j.storeUser(s.user,s.token),r(s.user),n.invalidateQueries("currentUser"),f.success("Registration successful!"),a("/dashboard")},onError:s=>{var v,R;f.error(((R=(v=s.response)==null?void 0:v.data)==null?void 0:R.error)||"Registration failed")}});return{user:t,isLoading:p||o,login:s=>d.mutateAsync(s),register:s=>m.mutateAsync(s),logout:()=>{j.logout(),r(null),n.clear(),f.success("Logged out successfully")},isLoggingIn:d.isLoading,isRegistering:m.isLoading}},ae=({children:t})=>{const{user:r,logout:p}=M();return console.log("Layout component rendering...",{user:r}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow",children:e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Employee Attendance System"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Welcome, ",r==null?void 0:r.firstName," ",r==null?void 0:r.lastName]}),e.jsx("button",{onClick:p,className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700",children:"Logout"})]})]})})}),e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"px-4 py-2",children:e.jsxs("nav",{className:"flex space-x-4",children:[e.jsx(y,{to:"/",className:"text-blue-600 font-medium",children:"Dashboard"}),(r==null?void 0:r.role)==="SUPER_ADMIN"||(r==null?void 0:r.role)==="HR_MANAGER"?e.jsxs(e.Fragment,{children:[e.jsx(y,{to:"/employees",className:"text-gray-600 hover:text-gray-900",children:"Employees"}),e.jsx(y,{to:"/attendance",className:"text-gray-600 hover:text-gray-900",children:"Attendance"}),e.jsx(y,{to:"/attendance-calendar",className:"text-gray-600 hover:text-gray-900",children:"Calendar"}),e.jsx(y,{to:"/attendance-reports",className:"text-gray-600 hover:text-gray-900",children:"Reports"}),e.jsx(y,{to:"/leave",className:"text-gray-600 hover:text-gray-900",children:"Leave"}),e.jsx(y,{to:"/shifts",className:"text-gray-600 hover:text-gray-900",children:"Shifts"}),e.jsx(y,{to:"/payroll",className:"text-gray-600 hover:text-gray-900",children:"Payroll"}),e.jsx(y,{to:"/payment-reports",className:"text-gray-600 hover:text-gray-900",children:"Payment Reports"}),(r==null?void 0:r.role)==="SUPER_ADMIN"&&e.jsx(e.Fragment,{children:e.jsx(y,{to:"/settings",className:"text-gray-600 hover:text-gray-900",children:"Settings"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{to:"/my-attendance",className:"text-gray-600 hover:text-gray-900",children:"My Attendance"}),e.jsx(y,{to:"/my-leave",className:"text-gray-600 hover:text-gray-900",children:"My Leave"}),e.jsx(y,{to:"/profile",className:"text-gray-600 hover:text-gray-900",children:"Profile"})]})]})})}),e.jsx("main",{className:"p-6",children:t})]})},b=l.memo(({size:t="md",className:r=""})=>{const p={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"};return e.jsx("div",{className:`flex items-center justify-center ${r}`,children:e.jsx("div",{className:`animate-spin rounded-full border-2 border-primary-200 border-t-primary-600 ${p[t]}`})})});b.displayName="LoadingSpinner";const ie=l.lazy(()=>x(()=>import("./Login-s7ezhjsn.js"),__vite__mapDeps([0,1,2,3,4,5]))),z=l.lazy(()=>x(()=>import("./Dashboard-B8DGAwS2.js"),__vite__mapDeps([6,1,2,4,7,8,9,3,10,11,5]))),le=l.lazy(()=>x(()=>import("./Employees-Bdz9ONmQ.js"),__vite__mapDeps([12,1,2,4,9,3,5]))),ce=l.lazy(()=>x(()=>import("./Attendance-DWfwe2Cl.js"),__vite__mapDeps([13,1,2,4,7,9,14,11,3,10,5]))),ue=l.lazy(()=>x(()=>import("./AttendanceCalendar-073ilu4D.js"),__vite__mapDeps([15,1,2,4,7,9,3,10,5]))),de=l.lazy(()=>x(()=>import("./AttendanceReports-DAACFgZ-.js"),__vite__mapDeps([16,1,2,4,7,9,3,5]))),me=l.lazy(()=>x(()=>import("./LeaveRequests-D8Edusqy.js"),__vite__mapDeps([17,1,2,4,8,9,3,5]))),pe=l.lazy(()=>x(()=>import("./MyAttendance-D2Me9Oi1.js"),__vite__mapDeps([18,1,2,4,7,10,3,5]))),ge=l.lazy(()=>x(()=>import("./MyLeave-BuU8D_F3.js"),__vite__mapDeps([19,1,2,4,8,3,5]))),he=l.lazy(()=>x(()=>import("./Profile-CeJynsGf.js"),__vite__mapDeps([20,3,1,2,4,5]))),fe=l.lazy(()=>x(()=>import("./ShiftManagement-Bqyi5Efv.js"),__vite__mapDeps([21,1,2,4,14,9,3,5]))),xe=l.lazy(()=>x(()=>import("./PayrollManagement-0PnWnSCu.js"),__vite__mapDeps([22,1,2,4,23,9,7,3,5]))),ye=l.lazy(()=>x(()=>import("./PaymentReports-BN26F2Wa.js"),__vite__mapDeps([24,1,2,4,23,9,3,5]))),je=l.lazy(()=>x(()=>import("./SystemSettings-Cko1Scjf.js"),__vite__mapDeps([25,1,2,4,3,5])));function _e(){const{user:t,isLoading:r}=M();if(r)return e.jsx(b,{});if(!t)return e.jsx(l.Suspense,{fallback:e.jsx(b,{}),children:e.jsxs(w,{children:[e.jsx(u,{path:"/login",element:e.jsx(ie,{})}),e.jsx(u,{path:"*",element:e.jsx(E,{to:"/login",replace:!0})})]})});const p=(t==null?void 0:t.role)==="SUPER_ADMIN"||(t==null?void 0:t.role)==="HR_MANAGER";return e.jsx(ae,{children:e.jsx(l.Suspense,{fallback:e.jsx(b,{}),children:e.jsxs(w,{children:[e.jsx(u,{path:"/",element:e.jsx(z,{})}),e.jsx(u,{path:"/dashboard",element:e.jsx(z,{})}),e.jsx(u,{path:"/profile",element:e.jsx(he,{})}),p?e.jsxs(e.Fragment,{children:[e.jsx(u,{path:"/employees",element:e.jsx(le,{})}),e.jsx(u,{path:"/attendance",element:e.jsx(ce,{})}),e.jsx(u,{path:"/attendance-calendar",element:e.jsx(ue,{})}),e.jsx(u,{path:"/attendance-reports",element:e.jsx(de,{})}),e.jsx(u,{path:"/leave",element:e.jsx(me,{})}),e.jsx(u,{path:"/shifts",element:e.jsx(fe,{})}),e.jsx(u,{path:"/payroll",element:e.jsx(xe,{})}),e.jsx(u,{path:"/payment-reports",element:e.jsx(ye,{})}),e.jsx(u,{path:"/settings",element:e.jsx(je,{})})]}):e.jsxs(e.Fragment,{children:[e.jsx(u,{path:"/my-attendance",element:e.jsx(pe,{})}),e.jsx(u,{path:"/my-leave",element:e.jsx(ge,{})}),e.jsx(u,{path:"/attendance",element:e.jsx(E,{to:"/my-attendance",replace:!0})}),e.jsx(u,{path:"/leave",element:e.jsx(E,{to:"/my-leave",replace:!0})})]}),e.jsx(u,{path:"/login",element:e.jsx(E,{to:"/",replace:!0})}),e.jsx(u,{path:"*",element:e.jsx(E,{to:"/",replace:!0})})]})})})}const ve=new G({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});se.createRoot(document.getElementById("root")).render(e.jsx(J.StrictMode,{children:e.jsx(H,{client:ve,children:e.jsxs(Q,{children:[e.jsx(_e,{}),e.jsx(Y,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{duration:5e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})})}));export{j as a,N as b,e as j,M as u};
//# sourceMappingURL=index-CJqNwkMI.js.map
