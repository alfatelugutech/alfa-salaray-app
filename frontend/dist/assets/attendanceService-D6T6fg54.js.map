{"version":3,"file":"attendanceService-D6T6fg54.js","sources":["../../src/services/attendanceService.ts"],"sourcesContent":["import api from './api'\r\nimport { Attendance, MarkAttendanceData, PaginatedResponse } from '../types'\r\n\r\nexport const attendanceService = {\r\n  // Mark attendance\r\n  async markAttendance(data: MarkAttendanceData): Promise<Attendance> {\r\n    console.log('ðŸŽ¯ Marking attendance with data:', data)\r\n    console.log('ðŸ”‘ Auth token:', localStorage.getItem('token'))\r\n    console.log('ðŸ‘¤ User:', localStorage.getItem('user'))\r\n    \r\n    const response = await api.post<{ success: boolean; data: { attendance: Attendance } }>('/attendance/mark', data)\r\n    return response.data.data.attendance\r\n  },\r\n\r\n  // Get attendance records\r\n  async getAttendance(params?: {\r\n    page?: number\r\n    limit?: number\r\n    employeeId?: string\r\n    startDate?: string\r\n    endDate?: string\r\n    status?: string\r\n  }): Promise<PaginatedResponse<Attendance>> {\r\n    const response = await api.get<PaginatedResponse<Attendance>>('/attendance', { params })\r\n    return response.data\r\n  },\r\n\r\n  // Get attendance by ID\r\n  async getAttendanceById(id: string): Promise<Attendance> {\r\n    const response = await api.get<{ success: boolean; data: { attendance: Attendance } }>(`/attendance/${id}`)\r\n    return response.data.data.attendance\r\n  },\r\n\r\n  // Update attendance\r\n  async updateAttendance(id: string, data: Partial<MarkAttendanceData>): Promise<Attendance> {\r\n    const response = await api.put<{ success: boolean; data: { attendance: Attendance } }>(`/attendance/${id}`, data)\r\n    return response.data.data.attendance\r\n  },\r\n\r\n  // Delete attendance\r\n  async deleteAttendance(id: string): Promise<void> {\r\n    await api.delete(`/attendance/${id}`)\r\n  },\r\n\r\n  // Get attendance statistics\r\n  async getAttendanceStats(params?: {\r\n    startDate?: string\r\n    endDate?: string\r\n  }): Promise<{\r\n    totalRecords: number\r\n    presentCount: number\r\n    absentCount: number\r\n    lateCount: number\r\n    attendanceRate: number\r\n  }> {\r\n    const response = await api.get<{ success: boolean; data: any }>('/attendance/stats/overview', { params })\r\n    return response.data.data\r\n  },\r\n\r\n  // Get employee attendance history\r\n  async getEmployeeAttendance(employeeId: string, params?: {\r\n    page?: number\r\n    limit?: number\r\n    startDate?: string\r\n    endDate?: string\r\n  }): Promise<PaginatedResponse<Attendance>> {\r\n    const response = await api.get<PaginatedResponse<Attendance>>(`/attendance/employee/${employeeId}`, { params })\r\n    return response.data\r\n  },\r\n\r\n  // Self check-in (employee marks own attendance)\r\n  async selfCheckIn(payload: {\r\n    isRemote?: boolean\r\n    notes?: string\r\n    checkInSelfie?: string\r\n    checkInLocation?: {\r\n      latitude?: number\r\n      longitude?: number\r\n      address?: string\r\n      accuracy?: number\r\n    } | null\r\n    deviceInfo?: any\r\n    shiftId?: string | null\r\n    userId?: string\r\n  }): Promise<Attendance> {\r\n    // Get user ID from localStorage if not provided\r\n    const userData = localStorage.getItem('user');\r\n    const userId = payload.userId || (userData ? JSON.parse(userData).id : null);\r\n    \r\n    if (!userId) {\r\n      throw new Error('User ID not found. Please login again.');\r\n    }\r\n\r\n    const response = await api.post<{ success: boolean; data: { attendance: Attendance } }>(\r\n      '/attendance/self/check-in',\r\n      { ...payload, userId }\r\n    )\r\n    return response.data.data.attendance\r\n  },\r\n\r\n  // Self check-out\r\n  async selfCheckOut(payload: {\r\n    notes?: string\r\n    checkOutSelfie?: string\r\n    checkOutLocation?: {\r\n      latitude?: number\r\n      longitude?: number\r\n      address?: string\r\n      accuracy?: number\r\n    } | null\r\n    userId?: string\r\n  }): Promise<Attendance> {\r\n    // Get user ID from localStorage if not provided\r\n    const userData = localStorage.getItem('user');\r\n    const userId = payload.userId || (userData ? JSON.parse(userData).id : null);\r\n    \r\n    if (!userId) {\r\n      throw new Error('User ID not found. Please login again.');\r\n    }\r\n\r\n    const response = await api.post<{ success: boolean; data: { attendance: Attendance } }>(\r\n      '/attendance/self/check-out',\r\n      { ...payload, userId }\r\n    )\r\n    return response.data.data.attendance\r\n  },\r\n\r\n  // Get current attendance status\r\n  async getAttendanceStatus(): Promise<{\r\n    status: {\r\n      canCheckIn: boolean\r\n      canCheckOut: boolean\r\n      isCompleted: boolean\r\n      currentTime: string\r\n      today: string\r\n    }\r\n    attendance: Attendance | null\r\n  }> {\r\n    // Get user ID from localStorage\r\n    const userData = localStorage.getItem('user');\r\n    const userId = userData ? JSON.parse(userData).id : null;\r\n    \r\n    if (!userId) {\r\n      throw new Error('User ID not found. Please login again.');\r\n    }\r\n\r\n    const response = await api.get<{ success: boolean; data: any }>('/attendance/self/status', {\r\n      params: { userId }\r\n    })\r\n    return response.data.data\r\n  }\r\n}\r\n\r\n\r\n\r\n"],"names":["attendanceService","data","api","params","id","employeeId","payload","userData","userId"],"mappings":"wCAGO,MAAMA,EAAoB,CAE/B,MAAM,eAAeC,EAA+C,CAClE,eAAQ,IAAI,mCAAoCA,CAAI,EACpD,QAAQ,IAAI,iBAAkB,aAAa,QAAQ,OAAO,CAAC,EAC3D,QAAQ,IAAI,WAAY,aAAa,QAAQ,MAAM,CAAC,GAEnC,MAAMC,EAAI,KAA6D,mBAAoBD,CAAI,GAChG,KAAK,KAAK,UAC5B,EAGA,MAAM,cAAcE,EAOuB,CAEzC,OADiB,MAAMD,EAAI,IAAmC,cAAe,CAAE,OAAAC,EAAQ,GACvE,IAClB,EAGA,MAAM,kBAAkBC,EAAiC,CAEvD,OADiB,MAAMF,EAAI,IAA4D,eAAeE,CAAE,EAAE,GAC1F,KAAK,KAAK,UAC5B,EAGA,MAAM,iBAAiBA,EAAYH,EAAwD,CAEzF,OADiB,MAAMC,EAAI,IAA4D,eAAeE,CAAE,GAAIH,CAAI,GAChG,KAAK,KAAK,UAC5B,EAGA,MAAM,iBAAiBG,EAA2B,CAChD,MAAMF,EAAI,OAAO,eAAeE,CAAE,EAAE,CACtC,EAGA,MAAM,mBAAmBD,EAStB,CAED,OADiB,MAAMD,EAAI,IAAqC,6BAA8B,CAAE,OAAAC,EAAQ,GACxF,KAAK,IACvB,EAGA,MAAM,sBAAsBE,EAAoBF,EAKL,CAEzC,OADiB,MAAMD,EAAI,IAAmC,wBAAwBG,CAAU,GAAI,CAAE,OAAAF,EAAQ,GAC9F,IAClB,EAGA,MAAM,YAAYG,EAaM,CAEtB,MAAMC,EAAW,aAAa,QAAQ,MAAM,EACtCC,EAASF,EAAQ,SAAWC,EAAW,KAAK,MAAMA,CAAQ,EAAE,GAAK,MAEvE,GAAI,CAACC,EACH,MAAM,IAAI,MAAM,wCAAwC,EAO1D,OAJiB,MAAMN,EAAI,KACzB,4BACA,CAAE,GAAGI,EAAS,OAAAE,CAAA,CAAO,GAEP,KAAK,KAAK,UAC5B,EAGA,MAAM,aAAaF,EAUK,CAEtB,MAAMC,EAAW,aAAa,QAAQ,MAAM,EACtCC,EAASF,EAAQ,SAAWC,EAAW,KAAK,MAAMA,CAAQ,EAAE,GAAK,MAEvE,GAAI,CAACC,EACH,MAAM,IAAI,MAAM,wCAAwC,EAO1D,OAJiB,MAAMN,EAAI,KACzB,6BACA,CAAE,GAAGI,EAAS,OAAAE,CAAA,CAAO,GAEP,KAAK,KAAK,UAC5B,EAGA,MAAM,qBASH,CAED,MAAMD,EAAW,aAAa,QAAQ,MAAM,EACtCC,EAASD,EAAW,KAAK,MAAMA,CAAQ,EAAE,GAAK,KAEpD,GAAI,CAACC,EACH,MAAM,IAAI,MAAM,wCAAwC,EAM1D,OAHiB,MAAMN,EAAI,IAAqC,0BAA2B,CACzF,OAAQ,CAAE,OAAAM,CAAA,CAAO,CAClB,GACe,KAAK,IACvB,CACF"}