const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-BYe55Q2H.js","assets/router-BXhMSvr3.js","assets/vendor-C8w-UNLI.js","assets/ui-BANi3Jhe.js","assets/query-DSXC375t.js","assets/utils-ngrFHoWO.js","assets/Dashboard-BCAcPkuW.js","assets/attendanceService-Djx-h3fj.js","assets/leaveService-BKIADpwc.js","assets/employeeService-CpNx_TMG.js","assets/camera-uGge9r08.js","assets/locationTrackingService-mUJnMJ8F.js","assets/Employees-Bx_IvwwT.js","assets/Attendance-6zf4_k9U.js","assets/shiftService-B2dEr5RB.js","assets/AttendanceCalendar-BJalsF4g.js","assets/AttendanceReports-DXttngIH.js","assets/LeaveRequests-CbnyUEil.js","assets/MyAttendance-Bfrnv-fO.js","assets/MyLeave-BbqiVp5m.js","assets/Profile-DomLnKAY.js","assets/ShiftManagement-DOdJWVZR.js","assets/PayrollManagement-DmX6EZ3A.js","assets/payrollService-Ivxr9Vn-.js","assets/PaymentReports-UkCLkK9N.js","assets/DepartmentManagement-DBQqaM5Y.js","assets/RoleManagement-I2-1PLvj.js","assets/SystemSettings-Br9jukdL.js"])))=>i.map(i=>d[i]);
import{r as F,a as $,g as J}from"./vendor-C8w-UNLI.js";import{r as l,u as Q,L as O,b as I,c,N as P,a as W,B as H}from"./router-BXhMSvr3.js";import{u as K,a as G,b as D,Q as Y,c as X}from"./query-DSXC375t.js";import{z as h,F as Z}from"./ui-BANi3Jhe.js";import{a as M}from"./utils-ngrFHoWO.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))x(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&x(i)}).observe(document,{childList:!0,subtree:!0});function p(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function x(s){if(s.ep)return;s.ep=!0;const a=p(s);fetch(s.href,a)}})();var k={exports:{}},S={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T;function ee(){if(T)return S;T=1;var e=F(),r=Symbol.for("react.element"),p=Symbol.for("react.fragment"),x=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(o,u,m){var d,y={},f=null,n=null;m!==void 0&&(f=""+m),u.key!==void 0&&(f=""+u.key),u.ref!==void 0&&(n=u.ref);for(d in u)x.call(u,d)&&!a.hasOwnProperty(d)&&(y[d]=u[d]);if(o&&o.defaultProps)for(d in u=o.defaultProps,u)y[d]===void 0&&(y[d]=u[d]);return{$$typeof:r,type:o,key:f,ref:n,props:y,_owner:s.current}}return S.Fragment=p,S.jsx=i,S.jsxs=i,S}var U;function te(){return U||(U=1,k.exports=ee()),k.exports}var t=te(),A={},C;function re(){if(C)return A;C=1;var e=$();return A.createRoot=e.createRoot,A.hydrateRoot=e.hydrateRoot,A}var se=re();const ne=J(se),oe="modulepreload",ae=function(e){return"/"+e},z={},g=function(r,p,x){let s=Promise.resolve();if(p&&p.length>0){let i=function(m){return Promise.all(m.map(d=>Promise.resolve(d).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=i(p.map(m=>{if(m=ae(m),m in z)return;z[m]=!0;const d=m.endsWith(".css"),y=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${y}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":oe,d||(f.as="script"),f.crossOrigin="",f.href=m,u&&f.setAttribute("nonce",u),document.head.appendChild(f),d)return new Promise((n,_)=>{f.addEventListener("load",n),f.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${m}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return r().catch(a)})},N="https://alfa-salaray-app.onrender.com/api",L=M.create({baseURL:N,timeout:1e4,headers:{"Content-Type":"application/json"}});console.log("ðŸ”— API Base URL:",N);console.log("ðŸŒ Environment:","production");const we=async()=>{try{const e=await M.get(`${N.replace("/api","")}/health`,{timeout:5e3});return console.log("âœ… Backend health check passed:",e.data),{isHealthy:!0,data:e.data}}catch(e){return console.error("âŒ Backend health check failed:",e.message),{isHealthy:!1,error:e.message}}};L.interceptors.request.use(e=>{const r=localStorage.getItem("token");return r&&(e.headers.Authorization=`Bearer ${r}`),e},e=>Promise.reject(e));L.interceptors.response.use(e=>e,e=>{var p,x,s,a,i,o,u,m,d,y,f,n,_,j,E,R,b;if(console.error("API Error:",{url:(p=e.config)==null?void 0:p.url,method:(x=e.config)==null?void 0:x.method,status:(s=e.response)==null?void 0:s.status,statusText:(a=e.response)==null?void 0:a.statusText,data:(i=e.response)==null?void 0:i.data,message:e.message,code:e.code}),((o=e.response)==null?void 0:o.status)===401)return localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login",Promise.reject(e);if(e.code==="ECONNABORTED"||e.message.includes("timeout"))return console.error("Request timeout - backend is not responding"),console.error("Backend URL:",N),h.error("Server timeout. The backend may be slow or overloaded. Please try again."),Promise.reject(e);if(e.code==="NETWORK_ERROR"||e.message==="Network Error"||e.code==="ERR_NETWORK")return console.error("Network error - backend may be unavailable at:",N),console.error("Full error:",e),h.error("Network error. Please check your internet connection and try again."),Promise.reject(e);if(e.code==="ECONNREFUSED"||e.message.includes("Connection refused"))return console.error("Connection refused - backend is not running"),h.error("Backend server is not running. Please contact support."),Promise.reject(e);if(((u=e.response)==null?void 0:u.status)===502||((m=e.response)==null?void 0:m.status)===503)return console.error("Backend service unavailable:",e.response.status),h.error("Backend service is temporarily unavailable. Please try again later."),Promise.reject(e);if(((d=e.response)==null?void 0:d.status)===429)return console.warn("Rate limit exceeded - backend may be temporarily unavailable"),h.error("Server is busy - please try again in a few minutes"),Promise.reject(e);if(((y=e.response)==null?void 0:y.status)>=500)return console.error("Server error:",(f=e.response)==null?void 0:f.data),h.error("Server error - please try again later"),Promise.reject(e);if(((n=e.response)==null?void 0:n.status)>=400&&((_=e.response)==null?void 0:_.status)<500){const B=((E=(j=e.response)==null?void 0:j.data)==null?void 0:E.error)||"Request failed";return h.error(B),Promise.reject(e)}const r=((b=(R=e.response)==null?void 0:R.data)==null?void 0:b.error)||e.message||"An error occurred";return h.error(r),Promise.reject(e)});const v={async login(e){const r=await L.post("/auth/login",e);return{user:r.data.data.user,token:r.data.data.token}},async register(e){const r=await L.post("/auth/register",e);return{user:r.data.data.user,token:r.data.data.token}},async getCurrentUser(){return(await L.get("/auth/me")).data.data.user},logout(){localStorage.removeItem("token"),localStorage.removeItem("user")},isAuthenticated(){try{const e=localStorage.getItem("token");return!(!e||e==="undefined"||e==="null"||e==="")}catch(e){return console.error("Error checking authentication:",e),!1}},getStoredUser(){try{const e=localStorage.getItem("user");return!e||e==="undefined"||e==="null"||e===""?null:e==="undefined"||e==="null"?(localStorage.removeItem("user"),localStorage.removeItem("token"),null):JSON.parse(e)}catch(e){return console.error("Error parsing stored user:",e),localStorage.removeItem("user"),localStorage.removeItem("token"),null}},storeUser(e,r){localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("token",r)}},V=()=>{const[e,r]=l.useState(null),[p,x]=l.useState(!0),s=K(),a=Q();l.useEffect(()=>{try{const n=v.getStoredUser();n&&v.isAuthenticated()&&r(n)}catch(n){console.error("Error initializing auth:",n),v.logout()}finally{x(!1)}},[]);const{data:i,isLoading:o}=G("currentUser",v.getCurrentUser,{enabled:!!e&&v.isAuthenticated(),retry:!1,onError:()=>{v.logout(),r(null)}});l.useEffect(()=>{i&&(r(i),v.storeUser(i,localStorage.getItem("token")))},[i]);const u=D(v.login,{onSuccess:n=>{v.storeUser(n.user,n.token),r(n.user),s.invalidateQueries("currentUser"),h.success("Login successful!"),a("/dashboard")},onError:n=>{var _,j,E,R,b;console.error("Login error:",n),((_=n.response)==null?void 0:_.status)===429?h.error("Server is busy - please try again in a few minutes"):((j=n.response)==null?void 0:j.status)===401?h.error("Invalid email or password"):((E=n.response)==null?void 0:E.status)===0||n.code==="NETWORK_ERROR"?h.error("Cannot connect to server - please check your internet connection"):h.error(((b=(R=n.response)==null?void 0:R.data)==null?void 0:b.error)||"Login failed")}}),m=D(v.register,{onSuccess:n=>{v.storeUser(n.user,n.token),r(n.user),s.invalidateQueries("currentUser"),h.success("Registration successful!"),a("/dashboard")},onError:n=>{var _,j;h.error(((j=(_=n.response)==null?void 0:_.data)==null?void 0:j.error)||"Registration failed")}});return{user:e,isLoading:p||o,login:n=>u.mutateAsync(n),register:n=>m.mutateAsync(n),logout:()=>{v.logout(),r(null),s.clear(),h.success("Logged out successfully")},isLoggingIn:u.isLoading,isRegistering:m.isLoading}},ie=({children:e})=>{const{user:r,logout:p}=V();console.log("Layout component rendering...",{user:r});const x=()=>{if(!r)return[];const s=[{name:"Dashboard",href:"/dashboard",icon:"ðŸ ",type:"main"}];return r.role==="SUPER_ADMIN"||r.role==="HR_MANAGER"?[...s,{name:"Attendance",icon:"ðŸ“Š",type:"dropdown",submenu:[{name:"Mark Attendance",href:"/attendance",icon:"ðŸ“"},{name:"Calendar View",href:"/attendance-calendar",icon:"ðŸ“…"},{name:"Reports",href:"/attendance-reports",icon:"ðŸ“ˆ"}]},{name:"Employees",icon:"ðŸ‘¥",type:"dropdown",submenu:[{name:"All Employees",href:"/employees",icon:"ðŸ‘¥"},{name:"Departments",href:"/departments",icon:"ðŸ¢"},{name:"Roles",href:"/roles",icon:"ðŸ‘¤"}]},{name:"Leave Management",icon:"ðŸ–ï¸",type:"dropdown",submenu:[{name:"Leave Requests",href:"/leave",icon:"ðŸ“‹"},{name:"My Leave",href:"/my-leave",icon:"ðŸ–ï¸"}]},{name:"Payroll",icon:"ðŸ’°",type:"dropdown",submenu:[{name:"Payroll Management",href:"/payroll",icon:"ðŸ’°"},{name:"Payment Reports",href:"/payment-reports",icon:"ðŸ’³"}]},{name:"Shifts",href:"/shifts",icon:"â°",type:"main"},...r.role==="SUPER_ADMIN"?[{name:"Settings",href:"/settings",icon:"âš™ï¸",type:"main"}]:[]]:[...s,{name:"My Attendance",href:"/my-attendance",icon:"ðŸ“…",type:"main"},{name:"My Leave",href:"/my-leave",icon:"ðŸ–ï¸",type:"main"},{name:"Profile",href:"/profile",icon:"ðŸ‘¤",type:"main"}]};return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("div",{className:"bg-white shadow",children:t.jsx("div",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Employee Attendance System"}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("span",{className:"text-sm text-gray-600",children:["Welcome, ",r==null?void 0:r.firstName," ",r==null?void 0:r.lastName]}),t.jsx("button",{onClick:p,className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700",children:"Logout"})]})]})})}),t.jsx("div",{className:"bg-white border-b shadow-sm",children:t.jsx("div",{className:"px-4 py-3",children:t.jsx("nav",{className:"flex flex-wrap gap-2",children:x().map((s,a)=>{var i;return t.jsxs("div",{className:"relative group",children:[s.type==="dropdown"?t.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 hover:shadow-sm cursor-pointer",children:[t.jsx("span",{className:"text-lg",children:s.icon}),t.jsx("span",{children:s.name}),t.jsx("span",{className:"text-xs",children:"â–¼"})]}):t.jsxs(O,{to:s.href||"#",className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 hover:shadow-sm",children:[t.jsx("span",{className:"text-lg",children:s.icon}),t.jsx("span",{children:s.name})]}),s.type==="dropdown"&&"submenu"in s&&t.jsx("div",{className:"absolute top-full left-0 mt-1 w-48 bg-white rounded-lg shadow-lg border opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50",children:t.jsx("div",{className:"py-2",children:(i=s.submenu)==null?void 0:i.map((o,u)=>t.jsxs(O,{to:o.href,className:"flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors",children:[t.jsx("span",{className:"text-lg",children:o.icon}),t.jsx("span",{children:o.name})]},u))})})]},a)})})})}),t.jsx("main",{className:"p-6",children:e})]})},w=l.memo(({size:e="md",className:r=""})=>{const p={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"};return t.jsx("div",{className:`flex items-center justify-center ${r}`,children:t.jsx("div",{className:`animate-spin rounded-full border-2 border-primary-200 border-t-primary-600 ${p[e]}`})})});w.displayName="LoadingSpinner";const le=l.lazy(()=>g(()=>import("./Login-BYe55Q2H.js"),__vite__mapDeps([0,1,2,3,4,5]))),q=l.lazy(()=>g(()=>import("./Dashboard-BCAcPkuW.js"),__vite__mapDeps([6,1,2,4,7,8,9,3,10,11,5]))),ce=l.lazy(()=>g(()=>import("./Employees-Bx_IvwwT.js"),__vite__mapDeps([12,1,2,4,9,3,5]))),ue=l.lazy(()=>g(()=>import("./Attendance-6zf4_k9U.js"),__vite__mapDeps([13,1,2,4,7,9,14,11,3,10,5]))),de=l.lazy(()=>g(()=>import("./AttendanceCalendar-BJalsF4g.js"),__vite__mapDeps([15,1,2,4,7,9,3,10,5]))),me=l.lazy(()=>g(()=>import("./AttendanceReports-DXttngIH.js"),__vite__mapDeps([16,1,2,4,7,9,3,5]))),pe=l.lazy(()=>g(()=>import("./LeaveRequests-CbnyUEil.js"),__vite__mapDeps([17,1,2,4,8,9,3,5]))),fe=l.lazy(()=>g(()=>import("./MyAttendance-Bfrnv-fO.js"),__vite__mapDeps([18,1,2,4,7,10,3,5]))),he=l.lazy(()=>g(()=>import("./MyLeave-BbqiVp5m.js"),__vite__mapDeps([19,1,2,4,8,3,5]))),ge=l.lazy(()=>g(()=>import("./Profile-DomLnKAY.js"),__vite__mapDeps([20,3,1,2,4,5]))),ye=l.lazy(()=>g(()=>import("./ShiftManagement-DOdJWVZR.js"),__vite__mapDeps([21,1,2,4,14,9,3,5]))),xe=l.lazy(()=>g(()=>import("./PayrollManagement-DmX6EZ3A.js"),__vite__mapDeps([22,1,2,4,23,9,7,3,5]))),ve=l.lazy(()=>g(()=>import("./PaymentReports-UkCLkK9N.js"),__vite__mapDeps([24,1,2,4,23,9,3,5]))),_e=l.lazy(()=>g(()=>import("./DepartmentManagement-DBQqaM5Y.js"),__vite__mapDeps([25,1,2,4,9,3,5]))),je=l.lazy(()=>g(()=>import("./RoleManagement-I2-1PLvj.js"),__vite__mapDeps([26,1,2,4,9,3,5]))),Ee=l.lazy(()=>g(()=>import("./SystemSettings-Br9jukdL.js"),__vite__mapDeps([27,1,2,4,3,5])));function Re(){const{user:e,isLoading:r}=V();if(r)return t.jsx(w,{});if(!e)return t.jsx(l.Suspense,{fallback:t.jsx(w,{}),children:t.jsxs(I,{children:[t.jsx(c,{path:"/login",element:t.jsx(le,{})}),t.jsx(c,{path:"*",element:t.jsx(P,{to:"/login",replace:!0})})]})});const p=(e==null?void 0:e.role)==="SUPER_ADMIN"||(e==null?void 0:e.role)==="HR_MANAGER";return t.jsx(ie,{children:t.jsx(l.Suspense,{fallback:t.jsx(w,{}),children:t.jsxs(I,{children:[t.jsx(c,{path:"/",element:t.jsx(q,{})}),t.jsx(c,{path:"/dashboard",element:t.jsx(q,{})}),t.jsx(c,{path:"/profile",element:t.jsx(ge,{})}),p?t.jsxs(t.Fragment,{children:[t.jsx(c,{path:"/employees",element:t.jsx(ce,{})}),t.jsx(c,{path:"/attendance",element:t.jsx(ue,{})}),t.jsx(c,{path:"/attendance-calendar",element:t.jsx(de,{})}),t.jsx(c,{path:"/attendance-reports",element:t.jsx(me,{})}),t.jsx(c,{path:"/leave",element:t.jsx(pe,{})}),t.jsx(c,{path:"/shifts",element:t.jsx(ye,{})}),t.jsx(c,{path:"/payroll",element:t.jsx(xe,{})}),t.jsx(c,{path:"/payment-reports",element:t.jsx(ve,{})}),t.jsx(c,{path:"/departments",element:t.jsx(_e,{})}),t.jsx(c,{path:"/roles",element:t.jsx(je,{})}),t.jsx(c,{path:"/settings",element:t.jsx(Ee,{})})]}):t.jsxs(t.Fragment,{children:[t.jsx(c,{path:"/my-attendance",element:t.jsx(fe,{})}),t.jsx(c,{path:"/my-leave",element:t.jsx(he,{})}),t.jsx(c,{path:"/attendance",element:t.jsx(P,{to:"/my-attendance",replace:!0})}),t.jsx(c,{path:"/leave",element:t.jsx(P,{to:"/my-leave",replace:!0})})]}),t.jsx(c,{path:"/login",element:t.jsx(P,{to:"/",replace:!0})}),t.jsx(c,{path:"*",element:t.jsx(P,{to:"/",replace:!0})})]})})})}const be=new Y({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});ne.createRoot(document.getElementById("root")).render(t.jsx(W.StrictMode,{children:t.jsx(X,{client:be,children:t.jsxs(H,{children:[t.jsx(Re,{}),t.jsx(Z,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{duration:5e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})})}));export{v as a,L as b,we as c,t as j,V as u};
//# sourceMappingURL=index-B0dpTzod.js.map
