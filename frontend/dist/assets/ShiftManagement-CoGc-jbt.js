import{j as e}from"./index-B0Hd79CT.js";import{r as u}from"./router-BXhMSvr3.js";import{u as Q,a as D,b as j}from"./query-DSXC375t.js";import{s as p}from"./shiftService-BHzrV1Tb.js";import{e as U}from"./employeeService-Bpvb34j3.js";import{U as T,P as z,C as $,f as B,T as P,z as x}from"./ui-BANi3Jhe.js";import"./vendor-C8w-UNLI.js";import"./utils-ngrFHoWO.js";const ee=()=>{var w;const[c,m]=u.useState(!1),[h,a]=u.useState(!1),[t,i]=u.useState(null),[l,d]=u.useState(null),[r,k]=u.useState(""),[b,q]=u.useState(""),f=Q(),{data:g,isLoading:A}=D({queryKey:["shifts",r,b],queryFn:()=>p.getShifts({search:r,isActive:b,limit:50})}),{data:v}=D({queryKey:["employees"],queryFn:()=>U.getEmployees({limit:100})}),N=j({mutationFn:p.createShift,onSuccess:()=>{f.invalidateQueries({queryKey:["shifts"]}),m(!1),x.success("Shift created successfully")},onError:s=>{var n,o;x.error(((o=(n=s.response)==null?void 0:n.data)==null?void 0:o.error)||"Failed to create shift")}}),y=j({mutationFn:({id:s,data:n})=>p.updateShift(s,n),onSuccess:()=>{f.invalidateQueries({queryKey:["shifts"]}),i(null),x.success("Shift updated successfully")},onError:s=>{var n,o;x.error(((o=(n=s.response)==null?void 0:n.data)==null?void 0:o.error)||"Failed to update shift")}}),E=j({mutationFn:p.deleteShift,onSuccess:()=>{f.invalidateQueries({queryKey:["shifts"]}),x.success("Shift deleted successfully")},onError:s=>{var n,o;x.error(((o=(n=s.response)==null?void 0:n.data)==null?void 0:o.error)||"Failed to delete shift")}}),S=j({mutationFn:p.assignShift,onSuccess:()=>{f.invalidateQueries({queryKey:["shifts"]}),a(!1),x.success("Shift assigned successfully")},onError:s=>{var n,o;x.error(((o=(n=s.response)==null?void 0:n.data)==null?void 0:o.error)||"Failed to assign shift")}}),M=s=>{N.mutate(s)},F=s=>{t&&y.mutate({id:t.id,data:s})},I=s=>{window.confirm("Are you sure you want to delete this shift?")&&E.mutate(s)},K=s=>{S.mutate(s)},C=s=>new Date(`2000-01-01T${s}:00`).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),L=s=>{const n=Math.floor(s/60),o=s%60;return`${n}h ${o}m`};return A?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Shift Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage work shifts and employee assignments"})]}),e.jsxs("div",{className:"flex space-x-3 mt-4 sm:mt-0",children:[e.jsxs("button",{onClick:()=>a(!0),className:"btn btn-secondary",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Assign Shift"]}),e.jsxs("button",{onClick:()=>m(!0),className:"btn btn-primary",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Create Shift"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search shifts...",value:r,onChange:s=>k(s.target.value),className:"input w-full"})}),e.jsxs("select",{value:b,onChange:s=>q(s.target.value),className:"input w-full sm:w-48",children:[e.jsx("option",{value:"",children:"All Shifts"}),e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:(w=g==null?void 0:g.data.shifts)==null?void 0:w.map(s=>{var n;return e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 mt-1",children:[e.jsx($,{className:"w-4 h-4 mr-1"}),C(s.startTime)," - ",C(s.endTime)]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>i(s),className:"text-blue-600 hover:text-blue-800",children:e.jsx(B,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>I(s.id),className:"text-red-600 hover:text-red-800",children:e.jsx(P,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Break Duration:"}),e.jsx("span",{children:L(s.breakDuration)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Status:"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Employees:"}),e.jsx("span",{children:((n=s.employees)==null?void 0:n.length)||0})]})]}),e.jsxs("button",{onClick:()=>{d(s),a(!0)},className:"w-full mt-4 btn btn-outline",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Assign Employees"]})]},s.id)})}),c&&e.jsx(O,{onClose:()=>m(!1),onSubmit:M,isLoading:N.isLoading}),t&&e.jsx(R,{shift:t,onClose:()=>i(null),onSubmit:F,isLoading:y.isLoading}),h&&e.jsx(G,{shift:l,employees:(v==null?void 0:v.data.employees)||[],onClose:()=>{a(!1),d(null)},onSubmit:K,isLoading:S.isLoading})]})},O=({onClose:c,onSubmit:m,isLoading:h})=>{const[a,t]=u.useState({name:"",startTime:"09:00",endTime:"17:00",breakDuration:60}),i=l=>{l.preventDefault(),m(a)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create New Shift"}),e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Shift Name"}),e.jsx("input",{type:"text",value:a.name,onChange:l=>t({...a,name:l.target.value}),className:"input",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Start Time"}),e.jsx("input",{type:"time",value:a.startTime,onChange:l=>t({...a,startTime:l.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"End Time"}),e.jsx("input",{type:"time",value:a.endTime,onChange:l=>t({...a,endTime:l.target.value}),className:"input",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Break Duration (minutes)"}),e.jsx("input",{type:"number",value:a.breakDuration,onChange:l=>t({...a,breakDuration:Number(l.target.value)}),className:"input",min:"0",max:"480"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:c,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:h,children:h?"Creating...":"Create Shift"})]})]})]})})},R=({shift:c,onClose:m,onSubmit:h,isLoading:a})=>{const[t,i]=u.useState({name:c.name,startTime:c.startTime,endTime:c.endTime,breakDuration:c.breakDuration}),l=d=>{d.preventDefault(),h(t)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Shift"}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Shift Name"}),e.jsx("input",{type:"text",value:t.name,onChange:d=>i({...t,name:d.target.value}),className:"input",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Start Time"}),e.jsx("input",{type:"time",value:t.startTime,onChange:d=>i({...t,startTime:d.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"End Time"}),e.jsx("input",{type:"time",value:t.endTime,onChange:d=>i({...t,endTime:d.target.value}),className:"input",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Break Duration (minutes)"}),e.jsx("input",{type:"number",value:t.breakDuration,onChange:d=>i({...t,breakDuration:Number(d.target.value)}),className:"input",min:"0",max:"480"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:m,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:a,children:a?"Updating...":"Update Shift"})]})]})]})})},G=({shift:c,employees:m,onClose:h,onSubmit:a,isLoading:t})=>{const[i,l]=u.useState({employeeId:"",shiftId:(c==null?void 0:c.id)||"",startDate:new Date().toISOString().split("T")[0],endDate:""}),d=r=>{r.preventDefault(),a(i)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:["Assign Shift ",c?`- ${c.name}`:""]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employee"}),e.jsxs("select",{value:i.employeeId,onChange:r=>l({...i,employeeId:r.target.value}),className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select Employee"}),m.map(r=>e.jsxs("option",{value:r.id,children:[r.user.firstName," ",r.user.lastName," - ",r.employeeId]},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Start Date"}),e.jsx("input",{type:"date",value:i.startDate,onChange:r=>l({...i,startDate:r.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"End Date (Optional)"}),e.jsx("input",{type:"date",value:i.endDate,onChange:r=>l({...i,endDate:r.target.value}),className:"input"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:h,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:t,children:t?"Assigning...":"Assign Shift"})]})]})]})})};export{ee as default};
//# sourceMappingURL=ShiftManagement-CoGc-jbt.js.map
